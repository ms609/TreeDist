# TreeDist

[![Project Status: The project has reached a stable, usable state but is
no longer being actively developed; support/maintenance will be provided
as time
allows.](http://www.repostatus.org/badges/latest/inactive.svg)](https://www.repostatus.org/#inactive)
[![codecov](https://codecov.io/gh/ms609/TreeDist/branch/master/graph/badge.svg)](https://codecov.io/gh/ms609/TreeDist)
[![CRAN Status
Badge](http://www.r-pkg.org/badges/version/TreeDist)](https://cran.r-project.org/package=TreeDist)
[![CRAN
Downloads](http://cranlogs.r-pkg.org/badges/TreeDist)](https://ms609.github.io/usage/#treedist)
[![DOI](https://zenodo.org/badge/196188301.svg)](https://zenodo.org/badge/latestdoi/196188301)

‘TreeDist’ is an R package that implements a suite of metrics that
quantify the topological distance between pairs of unweighted
phylogenetic trees. It also includes a simple ‘Shiny’ application to
allow the visualization of distance-based tree spaces, and functions to
calculate the information content of trees and splits.

‘TreeDist’ primarily employs metrics in the category of ‘generalized
Robinson–Foulds distances’: they are based on comparing splits
(bipartitions) between trees, and thus reflect the relationship data
within trees, with no reference to branch lengths.

## Generalized RF distances

The [Robinson-Foulds
distance](https://ms609.github.io/TreeDist/articles/Robinson-Foulds.html)
simply tallies the number of non-trivial splits (sometimes inaccurately
termed clades, nodes or edges) that occur in both trees – any splits
that are not perfectly identical contribute one point to the distance
score of zero, however similar or different they are. By overlooking
potential similarities between almost-identical splits, this
conservative approach has undesirable properties.

[‘Generalized’ RF
metrics](https://ms609.github.io/TreeDist/articles/Generalized-RF.html)
generate *matchings* that pair splits in one tree with similar splits in
the other. Each pair of splits is assigned a similarity score; the sum
of these scores in the optimal matching then quantifies the similarity
between two trees.

Different ways of calculating the the similarity between a pair of
splits lead to different tree distance metrics, implemented in the
functions below:

- [`MutualClusteringInfo()`](https://ms609.github.io/TreeDist/reference/TreeDistance.html),
  [`SharedPhylogeneticInfo()`](https://ms609.github.io/TreeDist/reference/TreeDistance.html)

  Smith (2020) scores matchings based on the amount of information that
  one partition contains about the other. The Mutual Phylogenetic
  Information assigns zero similarity to split pairs that cannot both
  exist on a single tree; The Mutual Clustering Information metric is
  more forgiving, and exhibits more desirable behaviour; it is the
  recommended metric for tree comparison. (Its complement,
  [`ClusteringInfoDistance()`](https://ms609.github.io/TreeDist/reference/TreeDistance.html),
  returns a tree distance.)

  [![Introduction to the Clustering Information
  Distance](reference/figures/CID_talk.png)](https://durham.cloud.panopto.eu/Panopto/Pages/Viewer.aspx?id=ca5ede19-d21a-40ce-8b9e-ac6e00d7e2c0)

- [`NyeSimilarity()`](https://ms609.github.io/TreeDist/reference/NyeSimilarity.html)

  Nye *et al.* (2006) score matchings according to the size of the
  largest split that is consistent with both of them, normalized against
  the Jaccard index. This approach is extended by Böcker *et al*. (2013)
  with the Jaccard-Robinson-Foulds metric (function
  [`JaccardRobinsonFoulds()`](https://ms609.github.io/TreeDist/reference/JaccardRobinsonFoulds.html)).

- [`MatchingSplitDistance()`](https://ms609.github.io/TreeDist/reference/MatchingSplitDistance.html)

  Bogdanowicz and Giaro (2012) and Lin *et al.* (2012) independently
  proposed counting the number of ‘mismatched’ leaves in a pair of
  splits.
  [`MatchingSplitInfoDistance()`](https://ms609.github.io/TreeDist/reference/TreeDistance.html)
  provides an information-based equivalent (Smith 2020).

The package also implements the variation of the path distance proposed
by Kendal and Colijn (2016) (function
[`KendallColijn()`](https://ms609.github.io/TreeDist/reference/KendallColijn.html)),
approximations of the Nearest-Neighbour Interchange (NNI) distance
(function
[`NNIDist()`](https://ms609.github.io/TreeDist/reference/NNIDist.html);
following Li *et al.* (1996)), and calculates the size (function
[`MASTSize()`](https://ms609.github.io/TreeDist/reference/MASTSize.html))
and information content (function
[`MASTInfo()`](https://ms609.github.io/TreeDist/reference/MASTSize.html))
of the Maximum Agreement Subtree.

For an implementation of the Tree Bisection and Reconnection (TBR)
distance, see the package
‘[TBRDist](https://ms609.github.io/TBRDist/index.html)’.

# Installation

Install and load the library from CRAN as follows:

``` r
install.packages('TreeDist')
library('TreeDist')
```

You can install the development version of the package with:

``` r
if(!require("curl")) install.packages("curl")
if(!require("remotes")) install.packages("remotes")
remotes::install_github("ms609/TreeDist")
```

# Tree space analysis

Construct tree spaces and readily visualize projected landscapes,
avoiding common analytical pitfalls (Smith, 2022), using the inbuilt
graphical user interface (Shiny GUI):

``` r
TreeDist::MapTrees()
```

![image](https://user-images.githubusercontent.com/1695515/164730749-0e4cad5e-dcd5-47c7-80ef-3464e776e0a6.png)

image

Serious analysts should consult the
[vignette](https://ms609.github.io/TreeDist/articles/treespace.html) for
a command-line interface.

# Documentation

- [Using
  ‘TreeDist’](https://ms609.github.io/TreeDist/articles/Using-TreeDist.html)

- [Package
  functions](https://ms609.github.io/TreeDist/reference/index.html)

- [Tree spaces with
  ‘TreeDist’](https://ms609.github.io/TreeDist/articles/treespace.html)

- [All vignettes](https://ms609.github.io/TreeDist/articles/)

# See also

Other R packages implementing tree distance functions include:

- ‘[ape](http://ape-package.ird.fr/)’:
  - `cophenetic.phylo()`: Cophenetic distance
  - `dist.topo()`: Path (topological) distance, Robinson-Foulds
    distance.
- ‘[phangorn](https://cran.r-project.org/package=phangorn)’
  - `treedist()`: Path, Robinson-Foulds and approximate SPR distances.
- ‘[Quartet](http://ms609.github.io/Quartet/)’: Triplet and Quartet
  distances, using the tqDist algorithm.
- ‘[TBRDist](http://ms609.github.io/TBRDist/)’: TBR and SPR distances on
  unrooted trees, using the ‘uspr’ C library.
- ‘[treespace](https://github.com/thibautjombart/treespace)’:
  Kendall-Colijn distance and tree space visualizations.
- ‘[distory](https://cran.r-project.org/package=distory)’
  (unmaintained): Geodesic distance

# References

- Böcker, S. *et al.* (2013) [The Generalized Robinson-Foulds
  metric](https://dx.doi.org/10.1007/978-3-642-40453-5_13). Algorithms
  in Bioinformatics. WABI 2013. *Lecture Notes in Computer Science*,
  8126, 156–69.

- Bogdanowicz, D. and Giaro, K. (2012) [Matching split distance for
  unrooted binary phylogenetic
  trees](https://dx.doi.org/10.1109/TCBB.2011.48). *IEEE/ACM
  Transactions on Computational Biology and Bioinformatics*, 9, 150–160.

- Kendall, M. and Colijn, C. (2016) [Mapping phylogenetic trees to
  reveal distinct patterns of
  evolution](https://dx.doi.org/10.1093/molbev/msw124). *Mol Biol Evol*,
  33, 2735–2743.

- Li, M., Tromp, J. and Zhang, L.-X. (1996) [Some notes on the nearest
  neighbour interchange
  distance](https://dx.doi.org/10.1007/3-540-61332-3_168). *Computing
  and Combinatorics*, Goos, G., Hartmanis, J., Leeuwen, J., Cai, J.-Y.,
  and Wong, C. K., eds. Springer, Berlin. 343–351.

- Nye, T.M.W. *et al.* (2006) [A novel algorithm and web-based tool for
  comparing two alternative phylogenetic
  trees](https://dx.doi.org/10.1093/bioinformatics/bti720).
  *Bioinformatics*, 22, 117–119.

- Smith, M.R. (2020) [Information theoretic Generalized Robinson-Foulds
  metrics for comparing phylogenetic
  trees](https://dx.doi.org/10.1093/bioinformatics/btaa614).
  *Bioinformatics*, 36, 5007–5013.

- Smith, M.R. (2022) [Robust analysis of phylogenetic tree
  space](https://dx.doi.org/10.1093/sysbio/syab100). *Systematic
  Biology*, 71, 1255–1270.

Please note that the ‘TreeDist’ project is released with a [Contributor
Code of Conduct](https://ms609.github.io/TreeDist/CODE_OF_CONDUCT.html).
By contributing to this project, you agree to abide by its terms.

# Package index

## Tree distance measures

Functions for calculating distances between pairs of trees.

- [`TreeDistance()`](https://ms609.github.io/TreeDist/reference/TreeDistance.md)
  [`SharedPhylogeneticInfo()`](https://ms609.github.io/TreeDist/reference/TreeDistance.md)
  [`DifferentPhylogeneticInfo()`](https://ms609.github.io/TreeDist/reference/TreeDistance.md)
  [`PhylogeneticInfoDistance()`](https://ms609.github.io/TreeDist/reference/TreeDistance.md)
  [`ClusteringInfoDistance()`](https://ms609.github.io/TreeDist/reference/TreeDistance.md)
  [`ExpectedVariation()`](https://ms609.github.io/TreeDist/reference/TreeDistance.md)
  [`MutualClusteringInfo()`](https://ms609.github.io/TreeDist/reference/TreeDistance.md)
  [`SharedPhylogeneticInfoSplits()`](https://ms609.github.io/TreeDist/reference/TreeDistance.md)
  [`MutualClusteringInfoSplits()`](https://ms609.github.io/TreeDist/reference/TreeDistance.md)
  [`MatchingSplitInfo()`](https://ms609.github.io/TreeDist/reference/TreeDistance.md)
  [`MatchingSplitInfoDistance()`](https://ms609.github.io/TreeDist/reference/TreeDistance.md)
  [`MatchingSplitInfoSplits()`](https://ms609.github.io/TreeDist/reference/TreeDistance.md)
  : Information-based generalized Robinson–Foulds distances

- [`NyeSimilarity()`](https://ms609.github.io/TreeDist/reference/NyeSimilarity.md)
  [`NyeSplitSimilarity()`](https://ms609.github.io/TreeDist/reference/NyeSimilarity.md)
  :

  Nye *et al*. (2006) tree comparison

- [`KendallColijn()`](https://ms609.github.io/TreeDist/reference/KendallColijn.md)
  [`KCVector()`](https://ms609.github.io/TreeDist/reference/KendallColijn.md)
  [`PathVector()`](https://ms609.github.io/TreeDist/reference/KendallColijn.md)
  [`SplitVector()`](https://ms609.github.io/TreeDist/reference/KendallColijn.md)
  [`KCDiameter()`](https://ms609.github.io/TreeDist/reference/KendallColijn.md)
  : Kendall–Colijn distance

- [`MatchingSplitDistance()`](https://ms609.github.io/TreeDist/reference/MatchingSplitDistance.md)
  [`MatchingSplitDistanceSplits()`](https://ms609.github.io/TreeDist/reference/MatchingSplitDistance.md)
  : Matching Split Distance

- [`HierarchicalMutualInfo()`](https://ms609.github.io/TreeDist/reference/HierarchicalMutualInfo.md)
  [`HMI()`](https://ms609.github.io/TreeDist/reference/HierarchicalMutualInfo.md)
  [`SelfHMI()`](https://ms609.github.io/TreeDist/reference/HierarchicalMutualInfo.md)
  [`EHMI()`](https://ms609.github.io/TreeDist/reference/HierarchicalMutualInfo.md)
  [`AHMI()`](https://ms609.github.io/TreeDist/reference/HierarchicalMutualInfo.md)
  : Hierarchical Mutual Information

- [`JaccardRobinsonFoulds()`](https://ms609.github.io/TreeDist/reference/JaccardRobinsonFoulds.md)
  [`JaccardSplitSimilarity()`](https://ms609.github.io/TreeDist/reference/JaccardRobinsonFoulds.md)
  : Jaccard–Robinson–Foulds metric

- [`MASTSize()`](https://ms609.github.io/TreeDist/reference/MASTSize.md)
  [`MASTInfo()`](https://ms609.github.io/TreeDist/reference/MASTSize.md)
  : Maximum Agreement Subtree size

- [`NNIDist()`](https://ms609.github.io/TreeDist/reference/NNIDist.md)
  [`NNIDiameter()`](https://ms609.github.io/TreeDist/reference/NNIDist.md)
  : Approximate Nearest Neighbour Interchange distance

- [`PathDist()`](https://ms609.github.io/TreeDist/reference/PathDist.md)
  : Path distance

- [`InfoRobinsonFoulds()`](https://ms609.github.io/TreeDist/reference/Robinson-Foulds.md)
  [`InfoRobinsonFouldsSplits()`](https://ms609.github.io/TreeDist/reference/Robinson-Foulds.md)
  [`RobinsonFoulds()`](https://ms609.github.io/TreeDist/reference/Robinson-Foulds.md)
  [`RobinsonFouldsMatching()`](https://ms609.github.io/TreeDist/reference/Robinson-Foulds.md)
  [`RobinsonFouldsSplits()`](https://ms609.github.io/TreeDist/reference/Robinson-Foulds.md)
  : Robinson–Foulds distances, with adjustments for phylogenetic
  information content

- [`SPRDist()`](https://ms609.github.io/TreeDist/reference/SPRDist.md) :
  Approximate the Subtree Prune and Regraft (SPR) distance.

- [`CompareAll()`](https://ms609.github.io/TreeDist/reference/CompareAll.md)
  : Distances between each pair of trees

- [`VisualizeMatching()`](https://ms609.github.io/TreeDist/reference/VisualizeMatching.md)
  : Visualize a matching

## Tree space

Functions for the construction, evaluation and exploration of tree
space.

- [`Islands()`](https://ms609.github.io/TreeDist/reference/Islands.md) :
  Find islands from distance matrix
- [`MSTSegments()`](https://ms609.github.io/TreeDist/reference/MSTSegments.md)
  [`StrainCol()`](https://ms609.github.io/TreeDist/reference/MSTSegments.md)
  : Add minimum spanning tree to plot, colouring by stress
- [`MapTrees()`](https://ms609.github.io/TreeDist/reference/MapTrees.md)
  [`Project()`](https://ms609.github.io/TreeDist/reference/MapTrees.md)
  : Graphical user interface for mapping distances and analysing tree
  space
- [`MappingQuality()`](https://ms609.github.io/TreeDist/reference/MappingQuality.md)
  [`ProjectionQuality()`](https://ms609.github.io/TreeDist/reference/MappingQuality.md)
  : Faithfulness of mapped distances
- [`SpectralEigens()`](https://ms609.github.io/TreeDist/reference/SpectralEigens.md)
  [`SpectralClustering()`](https://ms609.github.io/TreeDist/reference/SpectralEigens.md)
  : Eigenvalues for spectral clustering
- [`SumOfRanges()`](https://ms609.github.io/TreeDist/reference/cluster-statistics.md)
  [`SumOfVariances()`](https://ms609.github.io/TreeDist/reference/cluster-statistics.md)
  [`SumOfVars()`](https://ms609.github.io/TreeDist/reference/cluster-statistics.md)
  [`MeanCentroidDistance()`](https://ms609.github.io/TreeDist/reference/cluster-statistics.md)
  [`MeanCentDist()`](https://ms609.github.io/TreeDist/reference/cluster-statistics.md)
  [`MeanCentroidDist()`](https://ms609.github.io/TreeDist/reference/cluster-statistics.md)
  [`DistanceFromMedian()`](https://ms609.github.io/TreeDist/reference/cluster-statistics.md)
  [`DistFromMed()`](https://ms609.github.io/TreeDist/reference/cluster-statistics.md)
  [`MeanNN()`](https://ms609.github.io/TreeDist/reference/cluster-statistics.md)
  [`MeanMSTEdge()`](https://ms609.github.io/TreeDist/reference/cluster-statistics.md)
  : Cluster size statistics
- [`median(`*`<multiPhylo>`*`)`](https://ms609.github.io/TreeDist/reference/median.multiPhylo.md)
  : Median of a set of trees
- [`Plot3()`](https://ms609.github.io/TreeDist/reference/Plot3.md) :
  Pseudo-3D plotting

## Cluster analysis

Functions for identifying and interrogating clusters of trees.

- [`KMeansPP()`](https://ms609.github.io/TreeDist/reference/KMeansPP.md)
  : k-means++ clustering
- [`SumOfRanges()`](https://ms609.github.io/TreeDist/reference/cluster-statistics.md)
  [`SumOfVariances()`](https://ms609.github.io/TreeDist/reference/cluster-statistics.md)
  [`SumOfVars()`](https://ms609.github.io/TreeDist/reference/cluster-statistics.md)
  [`MeanCentroidDistance()`](https://ms609.github.io/TreeDist/reference/cluster-statistics.md)
  [`MeanCentDist()`](https://ms609.github.io/TreeDist/reference/cluster-statistics.md)
  [`MeanCentroidDist()`](https://ms609.github.io/TreeDist/reference/cluster-statistics.md)
  [`DistanceFromMedian()`](https://ms609.github.io/TreeDist/reference/cluster-statistics.md)
  [`DistFromMed()`](https://ms609.github.io/TreeDist/reference/cluster-statistics.md)
  [`MeanNN()`](https://ms609.github.io/TreeDist/reference/cluster-statistics.md)
  [`MeanMSTEdge()`](https://ms609.github.io/TreeDist/reference/cluster-statistics.md)
  : Cluster size statistics

## Information

Functions addressing the information content and entropy of splits.

- [`AllSplitPairings()`](https://ms609.github.io/TreeDist/reference/AllSplitPairings.md)
  : Variation of information for all split pairings
- [`Entropy()`](https://ms609.github.io/TreeDist/reference/Entropy.md)
  [`Ntropy()`](https://ms609.github.io/TreeDist/reference/Entropy.md) :
  Entropy in bits
- [`MeilaVariationOfInformation()`](https://ms609.github.io/TreeDist/reference/MeilaVariationOfInformation.md)
  [`MeilaMutualInformation()`](https://ms609.github.io/TreeDist/reference/MeilaVariationOfInformation.md)
  : Use variation of clustering information to compare pairs of splits
- [`SplitsCompatible()`](https://ms609.github.io/TreeDist/reference/SplitsCompatible.md)
  : Are splits compatible?
- [`SplitEntropy()`](https://ms609.github.io/TreeDist/reference/SplitEntropy.md)
  : Entropy of two splits
- [`SplitSharedInformation()`](https://ms609.github.io/TreeDist/reference/SplitSharedInformation.md)
  [`SplitDifferentInformation()`](https://ms609.github.io/TreeDist/reference/SplitSharedInformation.md)
  [`TreesConsistentWithTwoSplits()`](https://ms609.github.io/TreeDist/reference/SplitSharedInformation.md)
  [`LnTreesConsistentWithTwoSplits()`](https://ms609.github.io/TreeDist/reference/SplitSharedInformation.md)
  [`Log2TreesConsistentWithTwoSplits()`](https://ms609.github.io/TreeDist/reference/SplitSharedInformation.md)
  : Shared information content of two splits
- [`SplitwiseInfo()`](https://ms609.github.io/TreeDist/reference/TreeInfo.md)
  [`ClusteringEntropy()`](https://ms609.github.io/TreeDist/reference/TreeInfo.md)
  [`ClusteringInfo()`](https://ms609.github.io/TreeDist/reference/TreeInfo.md)
  [`ConsensusInfo()`](https://ms609.github.io/TreeDist/reference/TreeInfo.md)
  : Information content of splits within a tree

## Utility functions

Functions to facilitate interaction with the package.

- [`CompareAll()`](https://ms609.github.io/TreeDist/reference/CompareAll.md)
  : Distances between each pair of trees
- [`as.HPart()`](https://ms609.github.io/TreeDist/reference/HPart.md)
  [`is.HPart()`](https://ms609.github.io/TreeDist/reference/HPart.md)
  [`print(`*`<HPart>`*`)`](https://ms609.github.io/TreeDist/reference/HPart.md)
  [`as.phylo(`*`<HPart>`*`)`](https://ms609.github.io/TreeDist/reference/HPart.md)
  [`plot(`*`<HPart>`*`)`](https://ms609.github.io/TreeDist/reference/HPart.md)
  : Hierarchical partition structure
- [`LAPJV()`](https://ms609.github.io/TreeDist/reference/LAPJV.md) :
  Solve linear assignment problem using LAPJV
- [`Plot3()`](https://ms609.github.io/TreeDist/reference/Plot3.md) :
  Pseudo-3D plotting
- [`ReduceTrees()`](https://ms609.github.io/TreeDist/reference/ReduceTrees.md)
  : Collapse areas of agreement between two trees
- [`StartParallel()`](https://ms609.github.io/TreeDist/reference/StartParallel.md)
  [`SetParallel()`](https://ms609.github.io/TreeDist/reference/StartParallel.md)
  [`GetParallel()`](https://ms609.github.io/TreeDist/reference/StartParallel.md)
  [`StopParallel()`](https://ms609.github.io/TreeDist/reference/StartParallel.md)
  : Calculate distances in parallel
- [`VisualizeMatching()`](https://ms609.github.io/TreeDist/reference/VisualizeMatching.md)
  : Visualize a matching

# Articles

### Getting started

- [Calculate tree similarity with
  'TreeDist'](https://ms609.github.io/TreeDist/articles/Using-TreeDist.md):
- [Contextualizing tree
  distances](https://ms609.github.io/TreeDist/articles/using-distances.md):
- [Trees with different
  leaves](https://ms609.github.io/TreeDist/articles/different-leaves.md):

### Tree space analysis

- [Tree space
  analysis](https://ms609.github.io/TreeDist/articles/treespace.md):
- [Analysing landscapes of phylogenetic
  trees](https://ms609.github.io/TreeDist/articles/landscapes.md):
- [Comparing sets of trees from different
  analyses](https://ms609.github.io/TreeDist/articles/compare-treesets.md):

### Tree distance introductions

- [Comparing splits using information
  theory](https://ms609.github.io/TreeDist/articles/information.md):
- [Extending the Robinson-Foulds
  metric](https://ms609.github.io/TreeDist/articles/Robinson-Foulds.md):
- [Generalized Robinson-Foulds
  distances](https://ms609.github.io/TreeDist/articles/Generalized-RF.md):
