<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Graphical user interface for mapping distances and analysing tree space — MapTrees • TreeDist</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Graphical user interface for mapping distances and analysing tree space — MapTrees"><meta name="description" content='MapTrees() launches a "Shiny" application for the visualization and
evaluation of tree spaces.'><meta property="og:description" content='MapTrees() launches a "Shiny" application for the visualization and
evaluation of tree spaces.'><meta name="robots" content="noindex"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-BTKEG66D3F"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-BTKEG66D3F');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TreeDist</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.8.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/Using-TreeDist.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Function reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tree distance analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/Using-TreeDist.html">Calculate tree similarity with 'TreeDist'</a></li>
    <li><a class="dropdown-item" href="../articles/using-distances.html">Contextualizing tree distances</a></li>
    <li><a class="dropdown-item" href="../articles/different-leaves.html">Trees with different leaves</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tree space analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/treespace.html">Tree space analysis</a></li>
    <li><a class="dropdown-item" href="../articles/landscapes.html">Analysing landscapes of phylogenetic trees</a></li>
    <li><a class="dropdown-item" href="../articles/compare-treesets.html">Comparing sets of trees from different analyses</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tree distance introductions</h6></li>
    <li><a class="dropdown-item" href="../articles/information.html">Comparing splits using information theory</a></li>
    <li><a class="dropdown-item" href="../articles/Robinson-Foulds.html">Extending the Robinson-Foulds metric</a></li>
    <li><a class="dropdown-item" href="../articles/Generalized-RF.html">Generalized Robinson-Foulds distances</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/ms609/TreeDist"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Graphical user interface for mapping distances and analysing tree space</h1>
      <small class="dont-index">Source: <a href="https://github.com/ms609/TreeDist/blob/master/R/shiny.R" class="external-link"><code>R/shiny.R</code></a></small>
      <div class="d-none name"><code>MapTrees.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>MapTrees()</code> launches a "Shiny" application for the visualization and
evaluation of tree spaces.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MapTrees</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Project</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="input-tab">Input tab<a class="anchor" aria-label="anchor" href="#input-tab"></a></h2>
    <p>The input tab allows for the upload of sets of phylogenetic trees from file.
Trees at the start or end of a file can be excluded, and the number of trees
can be brought down to a manageable number by uniformly subsampling every
_n_th tree.  Samples of c. 100 trees can be analysed in seconds;
analysis of larger samples will take longer, particularly with slower
methods (e.g. quartet distances; Kruskal-1 MDS; large minimum spanning trees).</p>
<p>Different batches can be plotted with different colours / symbols.</p>
<p>If each tree is associated with a property – for example, the data or method
used to generate it, or its stratigraphic congruence – a list of properties
for each tree, with one entry per line/row, can be uploaded along with
the trees.  Points in tree space can then be styled according to the
corresponding property.</p>
<p>If trees are subsampled (using the "Sample every" slider), then the values
in the tree properties file can also be subsampled accordingly.
Unfortunately there is not yet support for multiple point property files;
one file will be applied to all trees, in the sequence that they were added
to memory.</p>
    </div>
    <div class="section level2">
    <h2 id="analysis-tab">Analysis tab<a class="anchor" aria-label="anchor" href="#analysis-tab"></a></h2>
    <p>Select from a suite of distance methods: clustering information and
phylogenetic information are quick and satisfactory; quartet is slow but
gives slightly better mappings; path is very fast but may not reflect
evolutionary signal very well; and Robinson–Foulds should probably never
be used for analysis; it is included for comparison purposes.</p>
<p>Principle components mappings should suffice for most purposes;
Sammon and Kruskal mappings are slower and seldom differ by much,
in character or quality, but may emphasize outliers more.</p>
<p>Partitioning around medoids or minimax-linkage hierarchical clustering
will typically find a close-to-optimal clustering where one exists;
select additional methods for a more exhaustive search.
To avoid redundant calculation, clusterings are only updated when
"recalculate clustering" is clicked, or the "maximum cluster number" slider
is modified; clustering solutions using more than this many clusters are
not considered
Clusterings with silhouette coefficients &lt; 0.25 are unlikely to represent
genuine structure and are not reported or depicted.</p>
    </div>
    <div class="section level2">
    <h2 id="display-tab">Display tab<a class="anchor" aria-label="anchor" href="#display-tab"></a></h2>
    <p>Up to 15 dimensions can be depicted; the quality of a mapping – that is,
the faithfulness of mapped distances to true tree-to-tree distances –
is quantified by the product of the Trustworthiness and Continuity metrics,
which should exceed 0.9 (at least).</p>
<p>An interactive 3D plot can be explored by dragging the mouse and scrolling,
but do be careful to check that three dimensions are enough to depict your
data accurately.</p>
<p>The minimum spanning tree is the shortest possible line selecting the chosen
subsample of trees; if it takes a convoluted zig-zagging route, then the
mapping is doing a poor job of reflecting true tree to tree distances.</p>
<p>Convex hulls are the smallest polygons enclosing all points in each cluster;
they are handy for spotting clusters, but their area does not correspond
to a genuine quantity, so should not be interpreted.</p>
<p>Tree numbers correspond to the sequence of trees in their original input
file, before subsampling.</p>
<p>Each tree is denoted by a point, whose symbol can be styled according to
cluster membership or according to the file that contains the tree,
with each click of "Add to existing" on the input tab constituting a
new batch with a new symbol.</p>
<p>Points can be coloured according to a category – the cluster or batch to
which they belong, or custom data provided in the Point Property File
on the input tab – or continuously, either by the sequence in which they
were added to memory, or according to custom data.</p>
    </div>
    <div class="section level2">
    <h2 id="exporting-tree-spaces">Exporting tree spaces<a class="anchor" aria-label="anchor" href="#exporting-tree-spaces"></a></h2>
    <p>A mapping can be saved to PDF or as a PNG bitmap at the size selected.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>A list of references employed when constructing the tree space is populated
according to the methods used; it would be appropriate to cite and briefly
discuss these studies in any publication using figures generated using
this application.  The application itself can be cited using
Smith (2020, 2022)</p>
    </div>
    <div class="section level2">
    <h2 id="references-1">References<a class="anchor" aria-label="anchor" href="#references-1"></a></h2>
    <p>Smith MR (2020).
“Information theoretic Generalized Robinson-Foulds metrics for comparing phylogenetic trees.”
<em>Bioinformatics</em>, <b>36</b>(20), 5007–5013.
<a href="https://doi.org/10.1093/bioinformatics/btaa614" class="external-link">doi:10.1093/bioinformatics/btaa614</a>
.<br><br> Smith MR (2022).
“Robust analysis of phylogenetic tree space.”
<em>Systematic Biology</em>, <b>71</b>(5), 1255–1270.
<a href="https://doi.org/10.1093/sysbio/syab100" class="external-link">doi:10.1093/sysbio/syab100</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Full detail of tree space analysis in R is provided in the accompanying
<a href="https://ms609.github.io/TreeDist/articles/treespace.html">vignette</a>.</p>
<p>Other tree space functions:
<code><a href="Islands.html">Islands</a>()</code>,
<code><a href="MSTSegments.html">MSTSegments</a>()</code>,
<code><a href="MappingQuality.html">MappingQuality</a>()</code>,
<code><a href="SpectralEigens.html">SpectralEigens</a>()</code>,
<code><a href="cluster-statistics.html">cluster-statistics</a></code>,
<code><a href="median.multiPhylo.html">median.multiPhylo</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><a href="https://orcid.org/0000-0001-5660-1727" class="external-link">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://smithlabdurham.github.io/" class="external-link">Martin R. Smith</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

