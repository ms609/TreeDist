<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Calculate and Map Distances Between Phylogenetic Trees • TreeDist</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Calculate and Map Distances Between Phylogenetic Trees">
<meta name="description" content="Implements measures of tree similarity, including information-based generalized Robinson-Foulds distances (Phylogenetic Information Distance, Clustering Information Distance, Matching Split Information Distance; Smith 2020) &lt;doi:10.1093/bioinformatics/btaa614&gt;; Jaccard-Robinson-Foulds distances (Bocker et al. 2013) &lt;doi:10.1007/978-3-642-40453-5_13&gt;, including the Nye et al. (2006) metric &lt;doi:10.1093/bioinformatics/bti720&gt;; the Matching Split Distance (Bogdanowicz &amp; Giaro 2012) &lt;doi:10.1109/TCBB.2011.48&gt;; Maximum Agreement Subtree distances; the Kendall-Colijn (2016) distance &lt;doi:10.1093/molbev/msw124&gt;, and the Nearest Neighbour Interchange (NNI) distance, approximated per Li et al. (1996) &lt;doi:10.1007/3-540-61332-3_168&gt;. Includes tools for visualizing mappings of tree space (Smith 2022) &lt;doi:10.1093/sysbio/syab100&gt;, for identifying islands of trees (Silva and Wilkinson 2021) &lt;doi:10.1093/sysbio/syab015&gt;, for calculating the median of sets of trees, and for computing the information content of trees and splits.">
<meta property="og:description" content="Implements measures of tree similarity, including information-based generalized Robinson-Foulds distances (Phylogenetic Information Distance, Clustering Information Distance, Matching Split Information Distance; Smith 2020) &lt;doi:10.1093/bioinformatics/btaa614&gt;; Jaccard-Robinson-Foulds distances (Bocker et al. 2013) &lt;doi:10.1007/978-3-642-40453-5_13&gt;, including the Nye et al. (2006) metric &lt;doi:10.1093/bioinformatics/bti720&gt;; the Matching Split Distance (Bogdanowicz &amp; Giaro 2012) &lt;doi:10.1109/TCBB.2011.48&gt;; Maximum Agreement Subtree distances; the Kendall-Colijn (2016) distance &lt;doi:10.1093/molbev/msw124&gt;, and the Nearest Neighbour Interchange (NNI) distance, approximated per Li et al. (1996) &lt;doi:10.1007/3-540-61332-3_168&gt;. Includes tools for visualizing mappings of tree space (Smith 2022) &lt;doi:10.1093/sysbio/syab100&gt;, for identifying islands of trees (Silva and Wilkinson 2021) &lt;doi:10.1093/sysbio/syab015&gt;, for calculating the median of sets of trees, and for computing the information content of trees and splits.">
<meta name="robots" content="noindex">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-BTKEG66D3F"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-BTKEG66D3F');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">TreeDist</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.8.0.9002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="articles/Using-TreeDist.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Function reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tree distance analysis</h6></li>
    <li><a class="dropdown-item" href="articles/Using-TreeDist.html">Calculate tree similarity with 'TreeDist'</a></li>
    <li><a class="dropdown-item" href="articles/using-distances.html">Contextualizing tree distances</a></li>
    <li><a class="dropdown-item" href="articles/different-leaves.html">Trees with different leaves</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tree space analysis</h6></li>
    <li><a class="dropdown-item" href="articles/treespace.html">Tree space analysis</a></li>
    <li><a class="dropdown-item" href="articles/landscapes.html">Analysing landscapes of phylogenetic trees</a></li>
    <li><a class="dropdown-item" href="articles/compare-treesets.html">Comparing sets of trees from different analyses</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tree distance introductions</h6></li>
    <li><a class="dropdown-item" href="articles/information.html">Comparing splits using information theory</a></li>
    <li><a class="dropdown-item" href="articles/Robinson-Foulds.html">Extending the Robinson-Foulds metric</a></li>
    <li><a class="dropdown-item" href="articles/Generalized-RF.html">Generalized Robinson-Foulds distances</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ms609/TreeDist"><span class="fa fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="treedist">TreeDist<a class="anchor" aria-label="anchor" href="#treedist"></a>
</h1></div>
<p><a href="https://www.repostatus.org/#inactive" class="external-link"><img src="http://www.repostatus.org/badges/latest/inactive.svg" alt="Project Status: The project has reached a stable, usable state but is no longer being actively developed; support/maintenance will be provided as time allows."></a> <a href="https://codecov.io/gh/ms609/TreeDist" class="external-link"><img src="https://codecov.io/gh/ms609/TreeDist/branch/master/graph/badge.svg" alt="codecov"></a> <a href="https://cran.r-project.org/package=TreeDist" class="external-link"><img src="http://www.r-pkg.org/badges/version/TreeDist" alt="CRAN Status Badge"></a> <a href="https://cran.r-project.org/package=TreeDist" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/TreeDist" alt="CRAN Downloads"></a> <a href="https://zenodo.org/badge/latestdoi/196188301" class="external-link"><img src="https://zenodo.org/badge/196188301.svg" alt="DOI"></a></p>
<p>‘TreeDist’ is an R package that implements a suite of metrics that quantify the topological distance between pairs of unweighted phylogenetic trees. It also includes a simple ‘Shiny’ application to allow the visualization of distance-based tree spaces, and functions to calculate the information content of trees and splits.</p>
<p>‘TreeDist’ primarily employs metrics in the category of ‘generalized Robinson–Foulds distances’: they are based on comparing splits (bipartitions) between trees, and thus reflect the relationship data within trees, with no reference to branch lengths.</p>
<div class="section level2">
<h2 id="generalized-rf-distances">Generalized RF distances<a class="anchor" aria-label="anchor" href="#generalized-rf-distances"></a>
</h2>
<p>The <a href="https://ms609.github.io/TreeDist/articles/Robinson-Foulds.html">Robinson-Foulds distance</a> simply tallies the number of non-trivial splits (sometimes inaccurately termed clades, nodes or edges) that occur in both trees – any splits that are not perfectly identical contribute one point to the distance score of zero, however similar or different they are. By overlooking potential similarities between almost-identical splits, this conservative approach has undesirable properties.</p>
<p><a href="https://ms609.github.io/TreeDist/articles/Generalized-RF.html">‘Generalized’ RF metrics</a> generate <em>matchings</em> that pair splits in one tree with similar splits in the other. Each pair of splits is assigned a similarity score; the sum of these scores in the optimal matching then quantifies the similarity between two trees.</p>
<p>Different ways of calculating the the similarity between a pair of splits lead to different tree distance metrics, implemented in the functions below:</p>
<ul>
<li>
<p><a href="https://ms609.github.io/TreeDist/reference/TreeDistance.html"><code>MutualClusteringInfo()</code></a>, <a href="https://ms609.github.io/TreeDist/reference/TreeDistance.html"><code>SharedPhylogeneticInfo()</code></a></p>
<p>Smith (2020) scores matchings based on the amount of information that one partition contains about the other. The Mutual Phylogenetic Information assigns zero similarity to split pairs that cannot both exist on a single tree; The Mutual Clustering Information metric is more forgiving, and exhibits more desirable behaviour; it is the recommended metric for tree comparison. (Its complement, <a href="https://ms609.github.io/TreeDist/reference/TreeDistance.html"><code>ClusteringInfoDistance()</code></a>, returns a tree distance.)</p>
<p><a href="https://durham.cloud.panopto.eu/Panopto/Pages/Viewer.aspx?id=ca5ede19-d21a-40ce-8b9e-ac6e00d7e2c0" class="external-link"><img src="reference/figures/CID_talk.png" alt="Introduction to the Clustering Information Distance"></a></p>
</li>
<li>
<p><a href="https://ms609.github.io/TreeDist/reference/NyeSimilarity.html"><code>NyeSimilarity()</code></a></p>
<p>Nye <em>et al.</em> (2006) score matchings according to the size of the largest split that is consistent with both of them, normalized against the Jaccard index. This approach is extended by Böcker <em>et al</em>. (2013) with the Jaccard-Robinson-Foulds metric (function <a href="https://ms609.github.io/TreeDist/reference/JaccardRobinsonFoulds.html"><code>JaccardRobinsonFoulds()</code></a>).</p>
</li>
<li>
<p><a href="https://ms609.github.io/TreeDist/reference/MatchingSplitDistance.html"><code>MatchingSplitDistance()</code></a></p>
<p>Bogdanowicz and Giaro (2012) and Lin <em>et al.</em> (2012) independently proposed counting the number of ‘mismatched’ leaves in a pair of splits. <a href="https://ms609.github.io/TreeDist/reference/TreeDistance.html"><code>MatchingSplitInfoDistance()</code></a> provides an information-based equivalent (Smith 2020).</p>
</li>
</ul>
<p>The package also implements the variation of the path distance proposed by Kendal and Colijn (2016) (function <a href="https://ms609.github.io/TreeDist/reference/KendallColijn.html"><code>KendallColijn()</code></a>), approximations of the Nearest-Neighbour Interchange (NNI) distance (function <a href="https://ms609.github.io/TreeDist/reference/NNIDist.html"><code>NNIDist()</code></a>; following Li <em>et al.</em> (1996)), and calculates the size (function <a href="https://ms609.github.io/TreeDist/reference/MASTSize.html"><code>MASTSize()</code></a>) and information content (function <a href="https://ms609.github.io/TreeDist/reference/MASTSize.html"><code>MASTInfo()</code></a>) of the Maximum Agreement Subtree.</p>
<p>For an implementation of the Tree Bisection and Reconnection (TBR) distance, see the package ‘<a href="https://ms609.github.io/TBRDist/index.html" class="external-link">TBRDist</a>’.</p>
</div>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<p>Install and load the library from CRAN as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'TreeDist'</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ms609.github.io/TreeDist/">'TreeDist'</a></span><span class="op">)</span></span></code></pre></div>
<p>You can install the development version of the package with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://jeroen.r-universe.dev/curl" class="external-link">"curl"</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"curl"</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://remotes.r-lib.org" class="external-link">"remotes"</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"ms609/TreeDist"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="tree-space-analysis">Tree space analysis<a class="anchor" aria-label="anchor" href="#tree-space-analysis"></a>
</h1>
<p>Construct tree spaces and readily visualize projected landscapes, avoiding common analytical pitfalls (Smith, 2022), using the inbuilt graphical user interface (Shiny GUI):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">TreeDist</span><span class="fu">::</span><span class="fu"><a href="reference/MapTrees.html">MapTrees</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="https://user-images.githubusercontent.com/1695515/164730749-0e4cad5e-dcd5-47c7-80ef-3464e776e0a6.png" alt="image"><div class="figcaption">image</div>
</div>
<p>Serious analysts should consult the <a href="https://ms609.github.io/TreeDist/articles/treespace.html">vignette</a> for a command-line interface.</p>
</div>
<div class="section level1">
<h1 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h1>
<ul>
<li><p><a href="https://ms609.github.io/TreeDist/articles/Using-TreeDist.html">Using ‘TreeDist’</a></p></li>
<li><p><a href="https://ms609.github.io/TreeDist/reference/index.html">Package functions</a></p></li>
<li><p><a href="https://ms609.github.io/TreeDist/articles/treespace.html">Tree spaces with ‘TreeDist’</a></p></li>
<li><p><a href="https://ms609.github.io/TreeDist/articles/">All vignettes</a></p></li>
</ul>
</div>
<div class="section level1">
<h1 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h1>
<p>Other R packages implementing tree distance functions include:</p>
<ul>
<li>‘<a href="http://ape-package.ird.fr/" class="external-link">ape</a>’:
<ul>
<li>
<code>cophenetic.phylo()</code>: Cophenetic distance</li>
<li>
<code>dist.topo()</code>: Path (topological) distance, Robinson-Foulds distance.</li>
</ul>
</li>
<li>‘<a href="https://cran.r-project.org/package=phangorn" class="external-link">phangorn</a>’
<ul>
<li>
<code>treedist()</code>: Path, Robinson-Foulds and approximate SPR distances.</li>
</ul>
</li>
<li>‘<a href="http://ms609.github.io/Quartet/" class="external-link">Quartet</a>’: Triplet and Quartet distances, using the tqDist algorithm.</li>
<li>‘<a href="http://ms609.github.io/TBRDist/" class="external-link">TBRDist</a>’: TBR and SPR distances on unrooted trees, using the ‘uspr’ C library.</li>
<li>‘<a href="https://github.com/thibautjombart/treespace" class="external-link">treespace</a>’: Kendall-Colijn distance and tree space visualizations.</li>
<li>‘<a href="https://cran.r-project.org/package=distory" class="external-link">distory</a>’ (unmaintained): Geodesic distance</li>
</ul>
</div>
<div class="section level1">
<h1 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h1>
<ul>
<li><p>Böcker, S. <em>et al.</em> (2013) <a href="https://dx.doi.org/10.1007/978-3-642-40453-5_13" class="external-link">The Generalized Robinson-Foulds metric</a>. Algorithms in Bioinformatics. WABI 2013. <em>Lecture Notes in Computer Science</em>, 8126, 156–69.</p></li>
<li><p>Bogdanowicz, D. and Giaro, K. (2012) <a href="https://dx.doi.org/10.1109/TCBB.2011.48" class="external-link">Matching split distance for unrooted binary phylogenetic trees</a>. <em>IEEE/ACM Transactions on Computational Biology and Bioinformatics</em>, 9, 150–160.</p></li>
<li><p>Kendall, M. and Colijn, C. (2016) <a href="https://dx.doi.org/10.1093/molbev/msw124" class="external-link">Mapping phylogenetic trees to reveal distinct patterns of evolution</a>. <em>Mol Biol Evol</em>, 33, 2735–2743.</p></li>
<li><p>Li, M., Tromp, J. and Zhang, L.-X. (1996) <a href="https://dx.doi.org/10.1007/3-540-61332-3_168" class="external-link">Some notes on the nearest neighbour interchange distance</a>. <em>Computing and Combinatorics</em>, Goos, G., Hartmanis, J., Leeuwen, J., Cai, J.-Y., and Wong, C. K., eds. Springer, Berlin. 343–351.</p></li>
<li><p>Nye, T.M.W. <em>et al.</em> (2006) <a href="https://dx.doi.org/10.1093/bioinformatics/bti720" class="external-link">A novel algorithm and web-based tool for comparing two alternative phylogenetic trees</a>. <em>Bioinformatics</em>, 22, 117–119.</p></li>
<li><p>Smith, M.R. (2020) <a href="https://dx.doi.org/10.1093/bioinformatics/btaa614" class="external-link">Information theoretic Generalized Robinson-Foulds metrics for comparing phylogenetic trees</a>. <em>Bioinformatics</em>, 36, 5007–5013.</p></li>
<li><p>Smith, M.R. (2022) <a href="https://dx.doi.org/10.1093/sysbio/syab100" class="external-link">Robust analysis of phylogenetic tree space</a>. <em>Systematic Biology</em>, 71, 1255–1270.</p></li>
</ul>
<p>Please note that the ‘TreeDist’ project is released with a <a href="https://ms609.github.io/TreeDist/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=TreeDist" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/ms609/TreeDist/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/ms609/TreeDist/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 3)</li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing TreeDist</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://smithlabdurham.github.io/" class="external-link">Martin R. Smith</a> <br><small class="roles"> Author, maintainer, copyright holder, programmer </small> <a href="https://orcid.org/0000-0001-5660-1727" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://smithlabdurham.github.io/" class="external-link">Martin R. Smith</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
