<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Evaluating tree distance metrics • TreeDist</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Evaluating tree distance metrics">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TreeDist</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9004</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/test.html">Unicode test</a>
    </li>
    <li>
      <a href="../articles/Tree-distance-metric-evaluation.html">Evaluating tree distance metrics</a>
    </li>
    <li>
      <a href="../articles/tree-distances.html">Measuring tree distance</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ms609/TreeDist">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Evaluating tree distance metrics</h1>
                        <h4 class="author">Martin R. Smith</h4>
            
            <h4 class="date">2019-08-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ms609/TreeDist/blob/master/vignettes/Tree-distance-metric-evaluation.Rmd"><code>vignettes/Tree-distance-metric-evaluation.Rmd</code></a></small>
      <div class="hidden name"><code>Tree-distance-metric-evaluation.Rmd</code></div>

    </div>

    
    
<!--```
  text(text_x, y <- y - 1, paste0(
    signif(VariationOfPhylogeneticInfo(tr, ref), 4), ' / ', pair_info
    ), cex=0.8, pos=4)
  #text(text_x, y <- y - 1, paste0(signif(VariationOfMatchingSplitInfo(tr, ref), 4),
                                  ' / ', pair_info), cex=0.8, pos=4)
  text(text_x, y <- y - 1, paste0(signif(VariationOfClusteringInfo(tr, ref), 4),
                                  ' / ',
                                  signif(ClusteringInfo(tr) +
                                           ClusteringInfo(ref), 4)),
       cex=0.8, pos=4)
  
  text(text_x, y <- y - 1, paste0(8-signif(NyeTreeSimilarity(tr, ref), 4),
                                  ' / 8'), cex=0.8, pos=4)
  text(text_x, y <- y - 1, paste0(signif(MatchingSplitDistance(tr, ref), 4),
                                  ' / 32'), cex=0.8, pos=4)
  
  text(text_x, y <- y - 1, paste0(Quartet::QuartetStatus(list(tr, ref))[2, 'd'],
                            ' / ', choose(11,4)), cex=0.8, pos=4)
  text(text_x, y <- y - 1, paste0(signif(tree_dist['path.difference'], 4)), cex=0.8, pos=4)
  text(text_x, y <- y - 1, paste0(phangorn::sprdist(tr, ref)[1]), cex=0.8, pos=4)
  text(text_x, y <- y - 1, paste0(tree_dist['symmetric.difference'], 
                                  ' / ', (11L - 3L) * 2L), cex=0.8, pos=4)
  #text(text_x, y <- y - 1, paste0(100 * signif(VariationOfMatchingSplitInfo(tr, ref) / pair_info, 4), '%'), cex=0.8, pos=4)
}
```-->
<div id="measuring-the-effectiveness-of-tree-distance-metrics" class="section level1">
<h1 class="hasAnchor">
<a href="#measuring-the-effectiveness-of-tree-distance-metrics" class="anchor"></a>Measuring the effectiveness of tree distance metrics</h1>
<p>The most fundamental desideratum for a tree distance metric is that it assigns higher distance scores (or lower similarity scores) to trees that are more different. A consideration of problematic cases shows that some metrics do not consistently meet this fundamental criterion.</p>
<p>Note that the value of the Nye <em>et al.</em> similarity metric has been converted to a measure of distance by subtracting its value from the maximum possible (eight).</p>
<div id="length-of-move" class="section level2">
<h2 class="hasAnchor">
<a href="#length-of-move" class="anchor"></a>Length of move</h2>
<p>If trees differ only in the location of a single taxon (see taxon 1 in the trees below), then the distance between two trees should correspond to the distance that this taxon has been moved.</p>
<p><img src="Tree-distance-metric-evaluation_files/figure-html/Moving-a-single-taxon-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The subtree pruning and regrafting (SPR) distance does not distinguish between these trees, as they differ only in the placement of a single tip.</p>
<p>The Matching Splits metric lacks the resolution to distinguish a move of two nodes from one of three.</p>
<p>The Robinson-Foulds, path difference and quartet metrics, in contrast, recognize trees in which this tip has been moved further as more distant from the starting tree.</p>
<table class="table">
<thead><tr class="header">
<th><strong>Measure</strong></th>
<th>Phylo. Inf.</th>
<th>MS Inf.</th>
<th>Clust. Inf.</th>
<th>Nye <em>et al.</em>
</th>
<th>MS Dist</th>
<th>Quartet</th>
<th>Path</th>
<th>SPR</th>
<th>RF</th>
</tr></thead>
<tbody><tr class="odd">
<td><strong>Length of move</strong></td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>Pass</td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>Pass</td>
</tr></tbody>
</table>
</div>
<div id="number-of-tips-moved" class="section level2">
<h2 class="hasAnchor">
<a href="#number-of-tips-moved" class="anchor"></a>Number of tips moved</h2>
<p>Intuitively, moving a pair of tips on a tree should lead to higher tree distances than moving a single tip. <!--

## This case is ambiguous, as the moves are equivalent to moving (10, 11) by one node; perhaps the quartet metric can be forgiven for allocating both moves an equivalent score.  Note that the VPI is counterintuitive in this case.
## 
## In the case of a short move, the Quartet, SPR and RF distances
## do not differ whether one or two tips are moved.  






--><!--

--></p>
<p>In the following situation, the Nye <em>et al</em>. metric assigns a higher distance to a move that relocates relocate a single tip than one that moves two tips to the same location, and the matching splits metric fails to differentiate between the two:</p>
<p><img src="Tree-distance-metric-evaluation_files/figure-html/Move-a-cherry-two-1.png" width="66%" style="display: block; margin: auto;"></p>
<table class="table">
<thead><tr class="header">
<th><strong>Measure</strong></th>
<th>Phylo. Inf.</th>
<th>MS Inf.</th>
<th>Clust. Inf.</th>
<th>Nye <em>et al.</em>
</th>
<th>MS Dist</th>
<th>Quartet</th>
<th>Path</th>
<th>SPR</th>
<th>RF</th>
</tr></thead>
<tbody><tr class="odd">
<td><strong>Two-node move</strong></td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>Pass</td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
</tr></tbody>
</table>
<!--



-->
</div>
<div id="number-of-moves-made" class="section level2">
<h2 class="hasAnchor">
<a href="#number-of-moves-made" class="anchor"></a>Number of moves made</h2>
<p>Moving one taxon a specified distance ought to result in a smaller difference than moving two taxa the same distance. As a simple example, exchanging a pair of taxa represents a larger change than moving one taxon adjacent to the other.</p>
<p>Following on from this, moving one tip or exchanging two tips ought to result in a smaller distance than the distance expected for a pair of random trees.</p>
<p><img src="Tree-distance-metric-evaluation_files/figure-html/Random-trees-vs-simple-moves-1.png" width="50%" style="display: block; margin: auto;"></p>
<p>A notable proportion (15.3%) of random trees receive a lower RF distance than trees that differ in the position of a single tip. The proportion remains non-trivial for the path difference (3.3%), but is below 1% for all other metrics.</p>
<p>Exchanging two tips generates the maximum possible value under arboreal measures, i.e. the Variation of Phylogenetic Information and Robinson-Foulds distances. As such, this simple exchange receives a higher distance than a pair of random trees would receive, overlooking the identical relationships in all non-swapped tips.</p>
<p>The path distance when two tips are exchanged is also higher than expected for a pair of random trees.</p>
<table class="table">
<thead><tr class="header">
<th><strong>Measure</strong></th>
<th>Phylo. Inf.</th>
<th>MS Inf.</th>
<th>Clust. Inf.</th>
<th>Nye <em>et al.</em>
</th>
<th>MS Dist</th>
<th>Quartet</th>
<th>Path</th>
<th>SPR</th>
<th>RF</th>
</tr></thead>
<tbody><tr class="odd">
<td><strong>Number of moves</strong></td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
</tr></tbody>
</table>
</div>
<div id="complexity-of-moves" class="section level2">
<h2 class="hasAnchor">
<a href="#complexity-of-moves" class="anchor"></a>Complexity of moves</h2>
<p>As a related example, I propose that a rearrangement that requires the translocation of more than half the tips in a tree ought to result in a higher distance score than any rearrangement in which a single tip is moved:</p>
<p><img src="Tree-distance-metric-evaluation_files/figure-html/simple-vs-complex-1.png" width="66%" style="display: block; margin: auto;"></p>
<p>In this example, the path metric fails this test.</p>
<table class="table">
<thead><tr class="header">
<th><strong>Measure</strong></th>
<th>Phylo. Inf.</th>
<th>MS Inf.</th>
<th>Clust. Inf.</th>
<th>Nye <em>et al.</em>
</th>
<th>MS Dist</th>
<th>Quartet</th>
<th>Path</th>
<th>SPR</th>
<th>RF</th>
</tr></thead>
<tbody><tr class="odd">
<td><strong>Complexity</strong></td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
</tr></tbody>
</table>
</div>
<div id="saturation" class="section level2">
<h2 class="hasAnchor">
<a href="#saturation" class="anchor"></a>Saturation</h2>
<p>A distance metric should distinguish slightly-perturbed trees from random trees and those that are more different from the starting tree than expected by chance.</p>
<p>The Robinson-Foulds metric can reach its maximum value when a single taxon is relocated from the most basal to the most derived point of a pectinate tree, representing a maximal value despite retaining relationship information about all other taxa. It thus lacks the capacity to distinguish a random tree from one that is selected to maximise the distance from the comparison tree.</p>
<p><img src="Tree-distance-metric-evaluation_files/figure-html/Pectinate-to-break-RF-1.png" width="66%" style="display: block; margin: auto;"></p>
<table class="table">
<thead><tr class="header">
<th><strong>Measure</strong></th>
<th>Phylo. Inf.</th>
<th>MS Inf.</th>
<th>Clust. Inf.</th>
<th>Nye <em>et al.</em>
</th>
<th>MS Dist</th>
<th>Quartet</th>
<th>Path</th>
<th>SPR</th>
<th>RF</th>
</tr></thead>
<tbody><tr class="odd">
<td><strong>Saturation</strong></td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>(?)</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
</tr></tbody>
</table>
<!--
## Islands

The distances reported by a tree distance metric imply a tree space. It is 
desirable that this space is somewhat even.  In particular, metrics in which 
trees form isolated islands, all an equal distance from one another but a great
distance from their nearest neighbours, are undesirable [@Bogdanowicz2012].






Bogdanowicz & Giaro [-@Bogdanowicz2012] report that islands exist in the quartet and path differences.  A similar proof [#TODO] can be constructed for the [XYZ] distance.


-->
</div>
<div id="heterogeneity-of-tree-space" class="section level2">
<h2 class="hasAnchor">
<a href="#heterogeneity-of-tree-space" class="anchor"></a>Heterogeneity of tree space</h2>
<p>Tree distances correspond to a non-Euclidian space comprising all possible trees. The nature of this space is difficult to visualize, but it is desirable that such a space is uniform and does not exhibit islands <span class="citation">(Bogdanowicz &amp; Giaro, 2012)</span>.</p>
<p><span class="citation">Kendall &amp; Colijn (2016)</span> evaluate tree metrics by examining the properties of the complete tree space for all 945 rooted six-tip trees. A rooted tree is equivalent to an unrooted tree with an additional tip added at the position of the root; as I am considering metrics on unrooted trees, I replicate and expand the analysis of <span class="citation">Kendall &amp; Colijn (2016)</span> on all 945 unrooted seven-tip trees.</p>
<p>The matrix plots below depict, by colour intensity (see histograms above for key), the distance between each pair of trees.<br>
Histograms are annotated with the number of unique values observed for each metric. Rows and columns correspond to each of the 945 unrooted 7-tip trees, sorted according to their topology; the coloured bars in the margins correspond to the six distinct unlabelled tree topologies on seven tips, as depicted below.</p>
<p>Note the bands in the Path distance, also evident under Matching Splits, which indicate that high distance values are disproportionately likely when comparing two trees of certain shapes.</p>
<p><img src="Tree-distance-metric-evaluation_files/figure-html/7-tip-trees-2-1.png" width="787.2" style="display: block; margin: auto;"></p>
<p><img src="Tree-distance-metric-evaluation_files/figure-html/7-tip-tree-shapes-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>The following figures visualize the tree spaces implied by each distance metric by (i) partitioning the data into eight clusters using <!--spectral clustering
[@Von_luxburg2007]--> heirarchical clustering with average linkage, as recommended for phylogenetic trees <span class="citation">(Stockham, Wang, &amp; Warnow, 2002; Yu Lin, Rajan, &amp; Moret, 2012)</span>; (ii) projecting the tree space into two dimensions using classical multidimensional scaling <span class="citation">(Gower, 1966)</span>; (iii) projecting the tree space into two dimensions using Kruskal’s Non-Metric Multidimensional Scaling <span class="citation">(Kruskal, 1964)</span>, which retains rank order of distances but not the distances themselves <span class="citation">(Cox &amp; Cox, 2001)</span>.</p>
<p>Heterogeneity is evident when clusters are equal in size and uniform in composition, and when points are concentrically distributed.</p>
<p><img src="Tree-distance-metric-evaluation_files/figure-html/7-tip-trees-3-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The information-based distance measures imply a heterogeneous tree space that is largely independent of tree topology. The Nye <em>et al.</em> and quartet metrics are largely heterogeneous, but certain tree shapes are slightly more prone to cluster together. The path distance contains many islands of trees, and these islands contain trees of a subset of tree topologies. The path, SPR and RF distances imply notably non-concentric treespaces.</p>
</div>
</div>
<div id="interpretability" class="section level1">
<h1 class="hasAnchor">
<a href="#interpretability" class="anchor"></a>Interpretability</h1>
<div id="unit-equivalence" class="section level2">
<h2 class="hasAnchor">
<a href="#unit-equivalence" class="anchor"></a>Unit equivalence</h2>
<p>A further shortcoming of the RF metric is that not all partitions represent an equivalent amount of information. A partition distance of 1 could mean that two trees differ in an less informative partition, or a more informative partition. All quartets, in contrast, are equally informative.</p>
<p>Consider a balanced and an unbalanced eight-taxon tree:</p>
<p><img src="Tree-distance-metric-evaluation_files/figure-html/two-trees-1.png" width="576"></p>
<p>Each tree divides the eight taxa into five bipartition splits.<br>
The information content (Shannon entropy) of a split can be calculated based on what proportion of eight-tip trees contain the split in question. This is a function of the evenness of the split:</p>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">Matching trees</th>
<th align="right">p(Match in random tree)</th>
<th align="right">Information content / bits</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Partition size: 2:6</td>
<td align="right">945</td>
<td align="right">0.0909</td>
<td align="right">3.459432</td>
</tr>
<tr class="even">
<td>Partition size: 3:5</td>
<td align="right">315</td>
<td align="right">0.0303</td>
<td align="right">5.044394</td>
</tr>
<tr class="odd">
<td>Partition size: 4:4</td>
<td align="right">225</td>
<td align="right">0.0216</td>
<td align="right">5.529821</td>
</tr>
</tbody>
</table>
<p>In the first tree, split 1 is even, dividing four taxa from four others (<code>4:4</code>); splits 2–5 are maximally uneven (<code>2:6</code>). The total information content of these five splits is 19.37, whereas that of the five splits in the second tree, of sizes <code>2:6</code>, <code>3:5</code>, <code>4:4</code>, <code>3:5</code> and <code>2:6</code>, is 22.54. Put another way, a random tree will on average share more partitions with the balanced tree (whose partitions are predominantly uneven and thus likely to be matched) than the asymmetric tree (which contains more even partitions that are less likely to occur in a random tree).</p>
<p>Of the 10 395 eight-tip trees, many more bear at least one partition in common with a balanced tree than with an asymmetric tree, whereas the distribution of quartets is identical:</p>
<p><img src="Tree-distance-metric-evaluation_files/figure-html/all-8-tip-trees-1.png" width="700"></p>
<p>This differing information content is reflected in the ranges taken by explicitly information-theoretic measures of tree similarity.<br>
This behaviour occurs because the information theoretic measures (including the quartet divergence) have units of bits, rather than arbitrary units. This said, although the range of the information-based equivalent to the matching splits distance matches that of the mutual phylogenetic information, it is not clear that the calculated information content of non-arboreal matches is a natural value.</p>
<table class="table">
<thead><tr class="header">
<th><strong>Measure</strong></th>
<th>Phylo. Inf.</th>
<th>MS Inf.</th>
<th>Clust. Inf.</th>
<th>Nye <em>et al.</em>
</th>
<th>MS Dist</th>
<th>Quartet</th>
<th>Path</th>
<th>SPR</th>
<th>RF</th>
</tr></thead>
<tbody><tr class="odd">
<td><strong>Meaningful units</strong></td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
</tr></tbody>
</table>
</div>
<div id="unit-context" class="section level2">
<h2 class="hasAnchor">
<a href="#unit-context" class="anchor"></a>Unit context</h2>
<p>It can also be useful to compare a tree distance to the distance expected for a pair of random trees.</p>
<p>The figure below shows how the median normalized tree distance varies with the number of tips in the trees being compared. 1 000 random pairs of <em>n</em>-tip trees were generated for <span class="math inline">\(4 \leq n \leq 200\)</span>, and the distances between them calcuated. Dashed and dotted envelopes respectively denote the 25–75% and 5–95% quantile ranges.</p>
<p>Information-based metrics, marked +, are normalized against the total information content of each pair of trees.</p>
<p>The Robinson-Fould, Nye <em>et al.</em> and Quartet Metrics (<span class="math inline">\(\triangledown\)</span>) are normalized based on the maximum possible value.</p>
<p>The SPR distance is normalized against a lower bound of its maximum possible value <span class="citation">(Allen &amp; Steel, 2001)</span>.</p>
<p>The Path and Matching Split metrics (×) do not have a readily calculated maximum value and are thus crudely normalized against an approximate maximum, calculated by curve-fitting the maximum observed distance for each number of tips.</p>
<p><img src="Tree-distance-metric-evaluation_files/figure-html/Tree-distance-averages-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Note that the path and Matching Splits distances exhibit a prominently larger standard deviation than other metrics, suggesting that they are less consistent in the score that they assign to a random pair of trees. In combination with the difficulty in calculating the range of these metrics, this makes their absolute value difficult to interpret.</p>
<table class="table">
<thead><tr class="header">
<th><strong>Measure</strong></th>
<th>Phylo. Inf.</th>
<th>MS Inf.</th>
<th>Clust. Inf.</th>
<th>Nye <em>et al.</em>
</th>
<th>MS Dist</th>
<th>Quartet</th>
<th>Path</th>
<th>SPR</th>
<th>RF</th>
</tr></thead>
<tbody><tr class="odd">
<td><strong>Value has context</strong></td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>(?)</td>
<td>Pass</td>
</tr></tbody>
</table>
</div>
</div>
<div id="versatility-non-bifurcating-trees" class="section level1">
<h1 class="hasAnchor">
<a href="#versatility-non-bifurcating-trees" class="anchor"></a>Versatility: Non-bifurcating trees</h1>
<p>Whereas the path distance and SPR metrics are only defined on bifurcating trees, symmetric difference approaches can be applied to trees that contain polytomies – i.e.  not every node is resolved as bifurcating.</p>
<table class="table">
<thead><tr class="header">
<th><strong>Measure</strong></th>
<th>Phylo. Inf.</th>
<th>MS Inf.</th>
<th>Clust. Inf.</th>
<th>Nye <em>et al.</em>
</th>
<th>MS Dist</th>
<th>Quartet</th>
<th>Path</th>
<th>SPR</th>
<th>RF</th>
</tr></thead>
<tbody><tr class="odd">
<td><strong>Polytomies</strong></td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>Pass</td>
</tr></tbody>
</table>
</div>
<div id="summary" class="section level1">
<h1 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h1>
<table class="table">
<thead><tr class="header">
<th><strong>Measure</strong></th>
<th>Phylo. Inf.</th>
<th>MS Inf.</th>
<th>Clust. Inf.</th>
<th>Nye <em>et al.</em>
</th>
<th>MS Dist</th>
<th>Quartet</th>
<th>Path</th>
<th>SPR</th>
<th>RF</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Length of move</strong></td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>Pass</td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>Pass</td>
</tr>
<tr class="even">
<td><strong>Two-node move</strong></td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>Pass</td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
</tr>
<tr class="odd">
<td><strong>Number of moves</strong></td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
</tr>
<tr class="even">
<td><strong>Complexity</strong></td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
</tr>
<tr class="odd">
<td><strong>Saturation</strong></td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>(?)</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
</tr>
<tr class="even">
<td><strong>Meaningful units</strong></td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
</tr>
<tr class="odd">
<td><strong>Value has context</strong></td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>(?)</td>
<td>Pass</td>
</tr>
<tr class="even">
<td><strong>Polytomies</strong></td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td>Pass</td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td><span style="color:red"><strong>FAIL</strong></span></td>
<td>Pass</td>
</tr>
</tbody>
</table>
<!--
## Interpretation

An advantage of the quartet symmetric distance is that the normalized metric of a random
tree is $\frac{2}{3}$ [@Day1986; @Steel1993].  As such, trees that are more different
than expected by chance can be readily recognized, as their distance metric
will be greater than $\frac{220}{330}$.
The 'maximum distance' tree depicted below was identified using the R package
`TreeSearch` [@TreeSearch], using the quartet difference from the reference tree 
as an optimality criterion.

<img src="Tree-distance-metric-evaluation_files/figure-html/Increasing-distances-1.png" width="90%" style="display: block; margin: auto;" />
-->
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-Allen2001">
<p>Allen, B. L., &amp; Steel, M. A. (2001). Subtree transfer operations and their induced metrics on evolutionary trees. <em>Annals of Combinatorics</em>, <em>5</em>(1), 1–15. doi: <a href="https://doi.org/10.1007/s00026-001-8006-8">10.1007/s00026-001-8006-8</a></p>
</div>
<div id="ref-Bogdanowicz2012">
<p>Bogdanowicz, D., &amp; Giaro, K. (2012). Matching split distance for unrooted binary phylogenetic trees. <em>IEEE/ACM Transactions on Computational Biology and Bioinformatics</em>, <em>9</em>(1), 150–160. doi: <a href="https://doi.org/10.1109/TCBB.2011.48">10.1109/TCBB.2011.48</a></p>
</div>
<div id="ref-Cox2001">
<p>Cox, T. F., &amp; Cox, M. A. A. (2001). <em>Multidimensional Scaling</em> (Second edition). Chapman; Hall / CRC.</p>
</div>
<div id="ref-Gower1966">
<p>Gower, J. C. (1966). Some distance properties of latent root and vector methods used in multivariate analysis. <em>Biometrika</em>, <em>53</em>(3/4), 325–338. doi: <a href="https://doi.org/10.2307/2333639">10.2307/2333639</a></p>
</div>
<div id="ref-Kendall2016">
<p>Kendall, M., &amp; Colijn, C. (2016). Mapping phylogenetic trees to reveal distinct patterns of evolution. <em>Molecular Biology and Evolution</em>, <em>33</em>(10), 2735–2743. doi: <a href="https://doi.org/10.1093/molbev/msw124">10.1093/molbev/msw124</a></p>
</div>
<div id="ref-Kruskal1964">
<p>Kruskal, J. B. (1964). Multidimensional scaling by optimizing goodness of fit to a nonmetric hypothesis. <em>Psychometrika</em>, <em>29</em>(1), 1–27. doi: <a href="https://doi.org/10.1007/BF02289565">10.1007/BF02289565</a></p>
</div>
<div id="ref-Stockham2002">
<p>Stockham, C., Wang, L.-S., &amp; Warnow, T. (2002). Statistically based postprocessing of phylogenetic analysis by clustering. <em>Bioinformatics</em>, <em>18</em>(Suppl 1), S285–S293. doi: <a href="https://doi.org/10.1093/bioinformatics/18.suppl_1.S285">10.1093/bioinformatics/18.suppl_1.S285</a></p>
</div>
<div id="ref-Lin2012">
<p>Yu Lin, Rajan, V., &amp; Moret, B. M. E. (2012). A metric for phylogenetic trees based on matching. <em>IEEE/ACM Transactions on Computational Biology and Bioinformatics</em>, <em>9</em>(4), 1014–1022. doi: <a href="https://doi.org/10.1109/TCBB.2011.157">10.1109/TCBB.2011.157</a></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#measuring-the-effectiveness-of-tree-distance-metrics">Measuring the effectiveness of tree distance metrics</a><ul class="nav nav-pills nav-stacked">
<li><a href="#length-of-move">Length of move</a></li>
      <li><a href="#number-of-tips-moved">Number of tips moved</a></li>
      <li><a href="#number-of-moves-made">Number of moves made</a></li>
      <li><a href="#complexity-of-moves">Complexity of moves</a></li>
      <li><a href="#saturation">Saturation</a></li>
      <li><a href="#heterogeneity-of-tree-space">Heterogeneity of tree space</a></li>
      </ul>
</li>
      <li>
<a href="#interpretability">Interpretability</a><ul class="nav nav-pills nav-stacked">
<li><a href="#unit-equivalence">Unit equivalence</a></li>
      <li><a href="#unit-context">Unit context</a></li>
      </ul>
</li>
      <li><a href="#versatility-non-bifurcating-trees">Versatility: Non-bifurcating trees</a></li>
      <li><a href="#summary">Summary</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Martin R. Smith.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
