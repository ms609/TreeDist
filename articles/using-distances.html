<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Contextualizing tree distances • TreeDist</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Contextualizing tree distances">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TreeDist</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Generalized-RF.html">Generalized Robinson-Foulds distances</a>
    </li>
    <li>
      <a href="../articles/Robinson-Foulds.html">Robinson-Foulds metric</a>
    </li>
    <li>
      <a href="../articles/Tree-distance-metric-evaluation.html">Evaluating tree distance metrics</a>
    </li>
    <li>
      <a href="../articles/Using-TreeDist.html">Using TreeDist to calculate tree similarity</a>
    </li>
    <li>
      <a href="../articles/information.html">Information theory</a>
    </li>
    <li>
      <a href="../articles/tree-distances.html">Measuring tree distance</a>
    </li>
    <li>
      <a href="../articles/using-distances.html">Contextualizing tree distances</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ms609/TreeDist">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Contextualizing tree distances</h1>
                        <h4 class="author"><a href="https://community.dur.ac.uk/martin.smith/">Martin R. Smith</a></h4>
            
            <h4 class="date">2019-09-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ms609/TreeDist/blob/master/vignettes/using-distances.Rmd"><code>vignettes/using-distances.Rmd</code></a></small>
      <div class="hidden name"><code>using-distances.Rmd</code></div>

    </div>

    
    
<p>Once you understand <a href="Using-TreeDist.html">how to use <em>TreeDist</em></a> to calculate tree distances, and <a href="tree-distances.html">what distances measure</a>, the next step is to provide some context for the calculated distances.</p>
<div id="normalizing" class="section level2">
<h2 class="hasAnchor">
<a href="#normalizing" class="anchor"></a>Normalizing</h2>
<p>The maximum value of most tree distance metrics scales with the number of terminals in the trees being compared. Typically, the resolution of the trees being compared also impacts the range of possible values. As such, it can be difficult to interpret the tree distance value without suitable context.</p>
<p>Normalizing a distance metric is one way to render its meaning more obvious. The appropriate normalizing constant may consider some thought, as it will depend on the purpose to which a tree distance metric is being put.</p>
<p>The default normalization behaviour of each functions in <em>TreeDist</em> is listed in the accompanying manual pages, visible under the <a href="reference/index.html">function reference</a> or by typing <code>?FunctionName</code> in the R terminal. This default behaviour is triggered by setting <code>normalize = TRUE</code>.</p>
<div id="nye-tree-similarity" class="section level3">
<h3 class="hasAnchor">
<a href="#nye-tree-similarity" class="anchor"></a>Nye tree similarity</h3>
<p>Let’s work through a simple example using the Nye <em>et al</em>. similarity metric to compare two imperfectly-resolved trees.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">'TreeDist'</span>)</a></code></pre></div>
<pre><code>## Registered S3 method overwritten by 'R.oo':
##   method        from       
##   throw.default R.methodsS3</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">tree1 &lt;-<span class="st"> </span>ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/read.tree.html">read.tree</a></span>(<span class="dt">text=</span><span class="st">'(A, ((B, ((C, D), (E, F))), (G, (H, (I, J, K)))));'</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">tree2 &lt;-<span class="st"> </span>ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/read.tree.html">read.tree</a></span>(<span class="dt">text=</span><span class="st">'(A, (B, (C, D, E, (J, K)), (G, ((H, I), F))));'</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw"><a href="../reference/VisualizeMatching.html">VisualizeMatching</a></span>(NyeTreeSimilarity, tree1, tree2,</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">                  <span class="dt">Plot=</span>TreeDistPlot, <span class="dt">matchZeros =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="using-distances_files/figure-html/unnamed-chunk-1-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>This is a nice metric to start with, because the maximum similarity between each pair of partitions is defined as one. (Astute readers might worry that the minimum similarity is greater than zero – that’s a harder problem to overcome.)</p>
<p>As such, the maximum similarity possible between two 11-tip trees is <a href="https://ms609.github.io/TreeSearch/reference/NPartitions.html"><code>NPartitions</code></a><code>(11)</code> = 8.</p>
<p>Normalizing against this value tells us how similar the two trees are, compared to two identical <em>fully bifurcating</em> eleven-tip trees; this is the default normalization method for <a href="reference/NyeTreeSimilarity.html"><code>NyeTreeSimilarity</code></a>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="../reference/NyeTreeSimilarity.html">NyeTreeSimilarity</a></span>(tree1, tree2, <span class="dt">normalize =</span> <span class="ot">FALSE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">8</span></a></code></pre></div>
<pre><code>## [1] 0.3065476</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/NyeTreeSimilarity.html">NyeTreeSimilarity</a></span>(tree1, tree2, <span class="dt">normalize =</span> <span class="dv">8</span>)</a></code></pre></div>
<pre><code>## [1] 0.3065476</code></pre>
<p>We might also be interested in comparing the tree similarity to the maximum score possible for two trees of the specified resolution. This value is given by the number of partitions in the least resolved of the two trees:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/NyeTreeSimilarity.html">NyeTreeSimilarity</a></span>(tree1, tree2, </a>
<a class="sourceLine" id="cb8-2" data-line-number="2">                  <span class="dt">normalize =</span> <span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="kw">NPartitions</span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(tree1, tree2))))</a></code></pre></div>
<pre><code>## [1] 0.4904762</code></pre>
<p>More concisely, we can provide a normalizing function:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="../reference/NyeTreeSimilarity.html">NyeTreeSimilarity</a></span>(tree1, tree2, <span class="dt">normalize =</span> min, <span class="dt">normalizeMax =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## [1] 0.4904762</code></pre>
<p>If we are comparing lists of trees, this best value will depend on the number of partitions in each pair of trees. We can use the function <code>pmin</code> to select the less resoved of each pair of trees:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="../reference/NyeTreeSimilarity.html">NyeTreeSimilarity</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(tree1, tree2), <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(tree1, tree2), </a>
<a class="sourceLine" id="cb12-2" data-line-number="2">                  <span class="dt">normalize =</span> pmin, <span class="dt">normalizeMax =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 1.0000000 0.4904762
## [2,] 0.4904762 1.0000000</code></pre>
<p>Finally, if <code>tree1</code> is a ‘target’ tree – perhaps one that has been used to simulate data from, or which is independently known to be true or virtuous – we may wish to normalize against the best possible match to that tree.</p>
<p>In that case, the best possible score is</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">TreeSearch<span class="op">::</span><span class="kw"><a href="https://ms609.github.io/TreeSearch/reference/NPartitions.html">NPartitions</a></span>(tree1)</a></code></pre></div>
<pre><code>## [1] 7</code></pre>
<p>and our normalized score will be</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="../reference/NyeTreeSimilarity.html">NyeTreeSimilarity</a></span>(tree1, tree2, <span class="dt">normalize =</span> <span class="kw">NPartitions</span>(tree1))</a></code></pre></div>
<pre><code>## [1] 0.3503401</code></pre>
</div>
</div>
<div id="testing-similarity-to-a-known-tree" class="section level2">
<h2 class="hasAnchor">
<a href="#testing-similarity-to-a-known-tree" class="anchor"></a>Testing similarity to a known tree</h2>
<ul>
<li><p>The precision/accuracy distinction</p></li>
<li><p>The role of information</p></li>
<li><p>A ternary plotting approach</p></li>
</ul>
</div>
<div id="what-next" class="section level2">
<h2 class="hasAnchor">
<a href="#what-next" class="anchor"></a>What next?</h2>
<ul>
<li><p>More details of the <a href="http://ms609.github.io/Ternary/">Ternary package</a></p></li>
<li><p>A summary of the <a href="tree-distances.html">distances implemented</a> in TreeDist</p></li>
</ul>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#normalizing">Normalizing</a></li>
      <li><a href="#testing-similarity-to-a-known-tree">Testing similarity to a known tree</a></li>
      <li><a href="#what-next">What next?</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://community.dur.ac.uk/martin.smith/">Martin R. Smith</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '8bf44d312479af73720c5ca5fcc12eba',
    indexName: 'treedist',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
