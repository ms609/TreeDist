<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Contextualizing tree distances • TreeDist</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Contextualizing tree distances">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TreeDist</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Generalized-RF.html">Generalized Robinson-Foulds distances</a>
    </li>
    <li>
      <a href="../articles/Robinson-Foulds.html">Robinson-Foulds metric</a>
    </li>
    <li>
      <a href="../articles/Tree-distance-metric-evaluation.html">Evaluating tree distance metrics</a>
    </li>
    <li>
      <a href="../articles/Using-TreeDist.html">Using TreeDist to calculate tree similarity</a>
    </li>
    <li>
      <a href="../articles/information.html">Information theory</a>
    </li>
    <li>
      <a href="../articles/tree-distances.html">Measuring tree distance</a>
    </li>
    <li>
      <a href="../articles/using-distances.html">Contextualizing tree distances</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ms609/TreeDist">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Contextualizing tree distances</h1>
                        <h4 class="author"><a href="https://community.dur.ac.uk/martin.smith/">Martin R. Smith</a></h4>
            
            <h4 class="date">2019-09-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ms609/TreeDist/blob/master/vignettes/using-distances.Rmd"><code>vignettes/using-distances.Rmd</code></a></small>
      <div class="hidden name"><code>using-distances.Rmd</code></div>

    </div>

    
    
<p>Once you understand <a href="Using-TreeDist.html">how to use <em>TreeDist</em></a> to calculate tree distances, and <a href="tree-distances.html">what distances measure</a>, the next step is to provide some context for the calculated distances.</p>
<div id="normalizing" class="section level2">
<h2 class="hasAnchor">
<a href="#normalizing" class="anchor"></a>Normalizing</h2>
<p>The maximum value of most tree distance metrics scales with the number of terminals in the trees being compared. Typically, the resolution of the trees being compared also impacts the range of possible values. As such, it can be difficult to interpret the tree distance value without suitable context.</p>
<p>Normalizing a distance metric is one way to render its meaning more obvious. The appropriate normalizing constant may consider some thought, as it will depend on the purpose to which a tree distance metric is being put.</p>
<p>The default normalization behaviour of each functions in <em>TreeDist</em> is listed in the accompanying manual pages, visible under the <a href="reference/index.html">function reference</a> or by typing <code>?FunctionName</code> in the R terminal. This default behaviour is triggered by setting <code>normalize = TRUE</code>.</p>
<div id="nye-tree-similarity" class="section level3">
<h3 class="hasAnchor">
<a href="#nye-tree-similarity" class="anchor"></a>Nye tree similarity</h3>
<p>Let’s work through a simple example using the Nye <em>et al</em>. similarity metric to compare two imperfectly-resolved trees.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">'TreeDist'</span>)</a></code></pre></div>
<pre><code>## Registered S3 method overwritten by 'R.oo':
##   method        from       
##   throw.default R.methodsS3</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">tree1 &lt;-<span class="st"> </span>ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/read.tree.html">read.tree</a></span>(<span class="dt">text=</span><span class="st">'(A, ((B, ((C, D), (E, F))), (G, (H, (I, J, K)))));'</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">tree2 &lt;-<span class="st"> </span>ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/read.tree.html">read.tree</a></span>(<span class="dt">text=</span><span class="st">'(A, (B, (C, D, E, (J, K)), (G, ((H, I), F))));'</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw"><a href="../reference/VisualizeMatching.html">VisualizeMatching</a></span>(NyeTreeSimilarity, tree1, tree2,</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">                  <span class="dt">Plot=</span>TreeDistPlot, <span class="dt">matchZeros =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="using-distances_files/figure-html/unnamed-chunk-1-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>This is a nice metric to start with, because the maximum similarity between each pair of partitions is defined as one. (Astute readers might worry that the minimum similarity is greater than zero – that’s a harder problem to overcome.)</p>
<p>As such, the maximum similarity possible between two 11-tip trees is <a href="https://ms609.github.io/TreeSearch/reference/NPartitions.html"><code>NPartitions</code></a><code>(11)</code> = 8.</p>
<p>Normalizing against this value tells us how similar the two trees are, compared to two identical <em>fully bifurcating</em> eleven-tip trees; this is the default normalization method for <a href="reference/NyeTreeSimilarity.html"><code>NyeTreeSimilarity</code></a>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="../reference/NyeTreeSimilarity.html">NyeTreeSimilarity</a></span>(tree1, tree2, <span class="dt">normalize =</span> <span class="ot">FALSE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">8</span></a></code></pre></div>
<pre><code>## [1] 0.3065476</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/NyeTreeSimilarity.html">NyeTreeSimilarity</a></span>(tree1, tree2, <span class="dt">normalize =</span> <span class="dv">8</span>)</a></code></pre></div>
<pre><code>## [1] 0.3065476</code></pre>
<p>We might also be interested in comparing the tree similarity to the maximum score possible for two trees of the specified resolution. This value is given by the number of partitions in the least resolved of the two trees:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/NyeTreeSimilarity.html">NyeTreeSimilarity</a></span>(tree1, tree2, </a>
<a class="sourceLine" id="cb8-2" data-line-number="2">                  <span class="dt">normalize =</span> <span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="kw">NPartitions</span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(tree1, tree2))))</a></code></pre></div>
<pre><code>## [1] 0.4904762</code></pre>
<p>More concisely, we can provide a normalizing function:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="../reference/NyeTreeSimilarity.html">NyeTreeSimilarity</a></span>(tree1, tree2, <span class="dt">normalize =</span> min, <span class="dt">normalizeMax =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## [1] 0.4904762</code></pre>
<p>If we are comparing lists of trees, this best value will depend on the number of partitions in each pair of trees. We can use the function <code>pmin</code> to select the less resoved of each pair of trees:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="../reference/NyeTreeSimilarity.html">NyeTreeSimilarity</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(tree1, tree2), <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(tree1, tree2), </a>
<a class="sourceLine" id="cb12-2" data-line-number="2">                  <span class="dt">normalize =</span> pmin, <span class="dt">normalizeMax =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 1.0000000 0.4904762
## [2,] 0.4904762 1.0000000</code></pre>
<p>Finally, if <code>tree1</code> is a ‘target’ tree – perhaps one that has been used to simulate data from, or which is independently known to be true or virtuous – we may wish to normalize against the best possible match to that tree.</p>
<p>In that case, the best possible score is</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">TreeSearch<span class="op">::</span><span class="kw"><a href="https://ms609.github.io/TreeSearch/reference/NPartitions.html">NPartitions</a></span>(tree1)</a></code></pre></div>
<pre><code>## [1] 7</code></pre>
<p>and our normalized score will be</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="../reference/NyeTreeSimilarity.html">NyeTreeSimilarity</a></span>(tree1, tree2, <span class="dt">normalize =</span> <span class="kw">NPartitions</span>(tree1))</a></code></pre></div>
<pre><code>## [1] 0.3503401</code></pre>
</div>
</div>
<div id="testing-similarity-to-a-known-tree" class="section level2">
<h2 class="hasAnchor">
<a href="#testing-similarity-to-a-known-tree" class="anchor"></a>Testing similarity to a known tree</h2>
<p>This score tells us how similar the two trees are. Similarity has two components: precision and accuracy. A tree can be 80% similar to a target tree because it contains 80% of the partitions in the target tree, and no incorrect partitions – or because it is perfectly bifurcating, but 10% of the partitions present are resolved incorrectly and are thus positively misleading.</p>
<p>In such a comparison, of course, it is more sensible to talk about partition information than just the number of partitions: an even partition may contain more information than two very uneven partitions, so the absence of two information-poor partitions may be preferable to the absence of one information-rich partition. As such, it is most instructive to think of the proportion of information that has been correctly resolved: the desideratum is that we find a tree that is as informative as possible about the true tree.</p>
<p>Ternary diagrams allow us to visualise the quality of a reconstructed tree with reference to a known ‘true’ tree:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">testTrees &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">  <span class="dt">trueTree =</span> ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/read.tree.html">read.tree</a></span>(<span class="dt">text=</span><span class="st">'(a, (b, (c, (d, (e, (f, (g, h)))))));'</span>),</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">  <span class="dt">lackRes =</span> ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/read.tree.html">read.tree</a></span>(<span class="dt">text=</span><span class="st">'(a, (b, c, (d, e, (f, g, h))));'</span>),</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">  <span class="dt">smallErr =</span> ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/read.tree.html">read.tree</a></span>(<span class="dt">text=</span><span class="st">'(a, (c, (b, (d, (f, (e, (g, h)))))));'</span>),</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">  <span class="dt">bigErr =</span> ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/read.tree.html">read.tree</a></span>(<span class="dt">text=</span><span class="st">'(a, (c, (((b, d), (f, h)), (e, g))));'</span>)</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="kw"><a href="../reference/VisualizeMatching.html">VisualizeMatching</a></span>(NyeTreeSimilarity, testTrees<span class="op">$</span>trueTree, testTrees<span class="op">$</span>lackRes)</a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">4</span>, <span class="fl">7.5</span>, <span class="dt">pch=</span><span class="dv">2</span>, <span class="dt">cex=</span><span class="dv">3</span>, <span class="dt">col=</span>Ternary<span class="op">::</span>cbPalette8[<span class="dv">2</span>])</a></code></pre></div>
<p><img src="using-distances_files/figure-html/unnamed-chunk-8-1.png" width="80%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw"><a href="../reference/VisualizeMatching.html">VisualizeMatching</a></span>(NyeTreeSimilarity, testTrees<span class="op">$</span>trueTree, testTrees<span class="op">$</span>smallErr)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">4</span>, <span class="fl">7.5</span>, <span class="dt">pch=</span><span class="dv">3</span>, <span class="dt">cex=</span><span class="dv">3</span>, <span class="dt">col=</span>Ternary<span class="op">::</span>cbPalette8[<span class="dv">3</span>])</a></code></pre></div>
<p><img src="using-distances_files/figure-html/unnamed-chunk-8-2.png" width="80%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw"><a href="../reference/VisualizeMatching.html">VisualizeMatching</a></span>(NyeTreeSimilarity, testTrees<span class="op">$</span>trueTree, testTrees<span class="op">$</span>bigErr)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dv">4</span>, <span class="fl">7.5</span>, <span class="dt">pch=</span><span class="dv">4</span>, <span class="dt">cex=</span><span class="dv">3</span>, <span class="dt">col=</span>Ternary<span class="op">::</span>cbPalette8[<span class="dv">4</span>])</a></code></pre></div>
<p><img src="using-distances_files/figure-html/unnamed-chunk-8-3.png" width="80%" style="display: block; margin: auto;"></p>
<p>Better trees plot vertically towards the ‘shared information’ vertex. Resolution of trees increases towards the right; trees that are more resolved may be no better than less-resolved trees if the addition of resolution introduces error.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">'Ternary'</span>)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mar=</span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0.1</span>, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="kw"><a href="https://ms609.github.io/Ternary/reference/TernaryPlot.html">TernaryPlot</a></span>(<span class="dt">atip=</span><span class="ot">NULL</span>, <span class="dt">btip=</span><span class="ot">NULL</span>, <span class="dt">ctip=</span><span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb21-4" data-line-number="4">            <span class="dt">alab=</span><span class="st">'Absent information'</span>, <span class="dt">blab=</span><span class="st">'Shared information'</span>, <span class="dt">clab=</span><span class="st">'Misinformation'</span>,</a>
<a class="sourceLine" id="cb21-5" data-line-number="5">            <span class="dt">lab.cex=</span><span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb21-6" data-line-number="6">            <span class="dt">lab.offset=</span><span class="fl">0.18</span>, <span class="co"># higher value as longer tick labels</span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7">            <span class="dt">point=</span><span class="st">'left'</span>, <span class="dt">clockwise=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb21-8" data-line-number="8">            <span class="co">#col=backgroundCol,</span></a>
<a class="sourceLine" id="cb21-9" data-line-number="9">            <span class="dt">grid.lty=</span><span class="st">'solid'</span>, <span class="dt">grid.col=</span><span class="st">'#aaaaaa'</span>,</a>
<a class="sourceLine" id="cb21-10" data-line-number="10">            <span class="dt">grid.minor.lines =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb21-11" data-line-number="11">            <span class="dt">axis.labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out=</span>11L),</a>
<a class="sourceLine" id="cb21-12" data-line-number="12">            <span class="dt">axis.col=</span><span class="st">"#999999"</span>,</a>
<a class="sourceLine" id="cb21-13" data-line-number="13">            <span class="dt">axis.labels.col =</span> <span class="st">"black"</span>,</a>
<a class="sourceLine" id="cb21-14" data-line-number="14">            <span class="dt">ticks.length =</span> <span class="fl">0.025</span>)</a></code></pre></div>
<pre><code>## Warning in plot.window(...): "clockwise" is not a graphical parameter</code></pre>
<pre><code>## Warning in plot.xy(xy, type, ...): "clockwise" is not a graphical parameter</code></pre>
<pre><code>## Warning in title(...): "clockwise" is not a graphical parameter</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw"><a href="https://ms609.github.io/Ternary/reference/TernaryPlot.html">HorizontalGrid</a></span>()</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">correct &lt;-<span class="st"> </span><span class="kw"><a href="../reference/TreeDistance.html">MutualClusteringInfo</a></span>(testTrees<span class="op">$</span>trueTree, testTrees)</a>
<a class="sourceLine" id="cb25-3" data-line-number="3">resolved &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ClusteringInfo.html">ClusteringInfo</a></span>(testTrees)</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">unresolved &lt;-<span class="st"> </span>resolved[<span class="st">'trueTree'</span>] <span class="op">-</span><span class="st"> </span>resolved</a>
<a class="sourceLine" id="cb25-5" data-line-number="5">incorrect &lt;-<span class="st"> </span>resolved <span class="op">-</span><span class="st"> </span>correct</a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="kw"><a href="https://ms609.github.io/Ternary/reference/AddToTernary.html">TernaryPoints</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(unresolved, correct, incorrect), </a>
<a class="sourceLine" id="cb25-7" data-line-number="7">              <span class="dt">pch=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">cex=</span><span class="dv">2</span>, <span class="dt">col=</span>Ternary<span class="op">::</span>cbPalette8[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])</a></code></pre></div>
<p><img src="using-distances_files/figure-html/unnamed-chunk-9-1.png" width="50%" style="display: block; margin: auto;"></p>
<div id="example" class="section level3">
<h3 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h3>
<p>Here’s a noddy real-world example applying this to a simulation-style study.</p>
<p>First, let’s generate a starting tree, which will represent our reference topology:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb26-2" data-line-number="2">trueTree &lt;-<span class="st"> </span>ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/rtree.html">rtree</a></span>(<span class="dv">20</span>)</a></code></pre></div>
<p>Then, let’s generate 200 degraded trees. We’ll move away from the true tree by making a TBR move, then reduce resolution by taking the consensus of this tree, and three trees in its immediate neighbourhood, one NNI move away.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">oneAway &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/structure.html">structure</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(<span class="dv">200</span>), <span class="cf">function</span> (x) {</a>
<a class="sourceLine" id="cb27-2" data-line-number="2">  tbrTree &lt;-<span class="st"> </span><span class="kw">TBR</span>(trueTree)</a>
<a class="sourceLine" id="cb27-3" data-line-number="3">  ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/consensus.html">consensus</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(tbrTree, <span class="kw">NNI</span>(tbrTree), <span class="kw">NNI</span>(tbrTree), <span class="kw">NNI</span>(tbrTree)))</a>
<a class="sourceLine" id="cb27-4" data-line-number="4">}), <span class="dt">class=</span><span class="st">'multiPhylo'</span>)</a></code></pre></div>
<p>And let’s generate 200 more trees that are even more degraded. This time we’ll move three TBR moves away from the true tree, and reduce resoluton by taking a consensus with three trees that are two NNI moves away.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">threeAway &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/structure.html">structure</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(<span class="dv">200</span>), <span class="cf">function</span> (x) {</a>
<a class="sourceLine" id="cb28-2" data-line-number="2">  tbrTree &lt;-<span class="st"> </span><span class="kw">TBR</span>(<span class="kw">TBR</span>(<span class="kw">TBR</span>(trueTree)))</a>
<a class="sourceLine" id="cb28-3" data-line-number="3">  ape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ape/man/consensus.html">consensus</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(tbrTree, <span class="kw">NNI</span>(<span class="kw">NNI</span>(tbrTree)),</a>
<a class="sourceLine" id="cb28-4" data-line-number="4">                      <span class="kw">NNI</span>(<span class="kw">NNI</span>(tbrTree)), <span class="kw">NNI</span>(<span class="kw">NNI</span>(tbrTree))))</a>
<a class="sourceLine" id="cb28-5" data-line-number="5">}), <span class="dt">class=</span><span class="st">'multiPhylo'</span>)</a></code></pre></div>
<p>Now let’s calculate their tree similarity scores. We need to calculate the amount of information each tree has in common with the true tree:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">correct1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/TreeDistance.html">MutualClusteringInfo</a></span>(trueTree, oneAway)</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">correct3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/TreeDistance.html">MutualClusteringInfo</a></span>(trueTree, threeAway)</a></code></pre></div>
<p>The amount of information in each degraded tree:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">infoInTree1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ClusteringInfo.html">ClusteringInfo</a></span>(oneAway)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">infoInTree3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ClusteringInfo.html">ClusteringInfo</a></span>(threeAway)</a></code></pre></div>
<p>The amount of information that could have been resolved, but was not:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">unresolved1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ClusteringInfo.html">ClusteringInfo</a></span>(trueTree) <span class="op">-</span><span class="st"> </span>infoInTree1</a>
<a class="sourceLine" id="cb31-2" data-line-number="2">unresolved3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ClusteringInfo.html">ClusteringInfo</a></span>(trueTree) <span class="op">-</span><span class="st"> </span>infoInTree3</a></code></pre></div>
<p>And the amount of information incorrectly resolved:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">incorrect1 &lt;-<span class="st"> </span>infoInTree1 <span class="op">-</span><span class="st"> </span>correct1</a>
<a class="sourceLine" id="cb32-2" data-line-number="2">incorrect3 &lt;-<span class="st"> </span>infoInTree3 <span class="op">-</span><span class="st"> </span>correct3</a></code></pre></div>
<p>Now we can plot this information on a ternary diagram. We’ll define some colours first: orange for the one-away trees, and blue for the three-aways:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1">col1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/grDevices/hcl.html">hcl</a></span>(<span class="dv">200</span>, <span class="dt">alpha =</span> <span class="fl">0.9</span>)</a>
<a class="sourceLine" id="cb33-2" data-line-number="2">col3 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/grDevices/hcl.html">hcl</a></span>(<span class="dv">40</span>, <span class="dt">alpha =</span> <span class="fl">0.9</span>)</a>
<a class="sourceLine" id="cb33-3" data-line-number="3">spec1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/grDevices/col2rgb.html">col2rgb</a></span>(col1, <span class="dt">alpha =</span> <span class="ot">TRUE</span>), <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">181</span>)</a>
<a class="sourceLine" id="cb33-4" data-line-number="4">spec3 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/grDevices/col2rgb.html">col2rgb</a></span>(col3, <span class="dt">alpha =</span> <span class="ot">TRUE</span>), <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">181</span>)</a>
<a class="sourceLine" id="cb33-5" data-line-number="5">spec1[<span class="dv">4</span>, ] &lt;-<span class="st"> </span>spec3[<span class="dv">4</span>, ] &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">180</span></a>
<a class="sourceLine" id="cb33-6" data-line-number="6">ColToHex &lt;-<span class="st"> </span><span class="cf">function</span> (x) <span class="kw"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(x[<span class="dv">1</span>], x[<span class="dv">2</span>], x[<span class="dv">3</span>], x[<span class="dv">4</span>], <span class="dt">maxColorValue =</span> <span class="dv">255</span>)</a>
<a class="sourceLine" id="cb33-7" data-line-number="7">spec1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(spec1, <span class="dv">2</span>, ColToHex)</a>
<a class="sourceLine" id="cb33-8" data-line-number="8">spec3 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(spec3, <span class="dv">2</span>, ColToHex)</a></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">'Ternary'</span>)</a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">ncol=</span><span class="dv">2</span>), <span class="dt">widths=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">5</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb34-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mar=</span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">0</span>, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb34-4" data-line-number="4"><span class="kw"><a href="https://ms609.github.io/Ternary/reference/TernaryPlot.html">TernaryPlot</a></span>(<span class="dt">alab=</span><span class="st">'Information absent in degraded tree'</span>, </a>
<a class="sourceLine" id="cb34-5" data-line-number="5">            <span class="dt">blab=</span><span class="st">'</span><span class="ch">\n\n</span><span class="st">Correct information in degraded tree'</span>, </a>
<a class="sourceLine" id="cb34-6" data-line-number="6">            <span class="dt">clab=</span><span class="st">'Misinformation in degraded tree'</span>,</a>
<a class="sourceLine" id="cb34-7" data-line-number="7">            <span class="dt">point=</span><span class="st">'left'</span>, <span class="dt">clockwise=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb34-8" data-line-number="8">            <span class="dt">grid.minor.lines =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb34-9" data-line-number="9">            <span class="dt">axis.labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out=</span>11L))</a></code></pre></div>
<pre><code>## Warning in plot.window(...): "clockwise" is not a graphical parameter</code></pre>
<pre><code>## Warning in plot.xy(xy, type, ...): "clockwise" is not a graphical parameter</code></pre>
<pre><code>## Warning in title(...): "clockwise" is not a graphical parameter</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw"><a href="https://ms609.github.io/Ternary/reference/TernaryPlot.html">HorizontalGrid</a></span>()</a>
<a class="sourceLine" id="cb38-2" data-line-number="2"></a>
<a class="sourceLine" id="cb38-3" data-line-number="3">coords1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(unresolved1, correct1, incorrect1)</a>
<a class="sourceLine" id="cb38-4" data-line-number="4">coords3 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(unresolved3, correct3, incorrect3)</a>
<a class="sourceLine" id="cb38-5" data-line-number="5"></a>
<a class="sourceLine" id="cb38-6" data-line-number="6"><span class="kw"><a href="https://ms609.github.io/Ternary/reference/ColourTernary.html">ColourTernary</a></span>(<span class="kw"><a href="https://ms609.github.io/Ternary/reference/TernaryPointValues.html">TernaryDensity</a></span>(coords1, <span class="dt">resolution =</span> <span class="dv">20</span>), <span class="dt">spectrum =</span> spec1)</a>
<a class="sourceLine" id="cb38-7" data-line-number="7"><span class="kw"><a href="https://ms609.github.io/Ternary/reference/ColourTernary.html">ColourTernary</a></span>(<span class="kw"><a href="https://ms609.github.io/Ternary/reference/TernaryPointValues.html">TernaryDensity</a></span>(coords3, <span class="dt">resolution =</span> <span class="dv">20</span>), <span class="dt">spectrum =</span> spec3)</a>
<a class="sourceLine" id="cb38-8" data-line-number="8"></a>
<a class="sourceLine" id="cb38-9" data-line-number="9"><span class="kw"><a href="https://ms609.github.io/Ternary/reference/TernaryDensityContour.html">TernaryDensityContour</a></span>(coords3, <span class="dt">col =</span> col3, <span class="dt">nlevels =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb38-10" data-line-number="10"><span class="kw"><a href="https://ms609.github.io/Ternary/reference/TernaryDensityContour.html">TernaryDensityContour</a></span>(coords1, <span class="dt">col =</span> col1, <span class="dt">nlevels =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb38-11" data-line-number="11"></a>
<a class="sourceLine" id="cb38-12" data-line-number="12">HorizontalHistogram &lt;-<span class="st"> </span><span class="cf">function</span> (dat, col, <span class="dt">add =</span> <span class="ot">FALSE</span>) {</a>
<a class="sourceLine" id="cb38-13" data-line-number="13">  breaks &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">41</span>)</a>
<a class="sourceLine" id="cb38-14" data-line-number="14">  histy &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(dat, <span class="dt">breaks =</span> breaks, <span class="dt">plot =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb38-15" data-line-number="15">  <span class="kw"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span>(histy<span class="op">$</span>density, <span class="dt">space =</span> <span class="dv">0</span>, <span class="dt">horiz =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb38-16" data-line-number="16">          <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">names.arg =</span> <span class="st">''</span>, </a>
<a class="sourceLine" id="cb38-17" data-line-number="17">          <span class="dt">col =</span> col, <span class="dt">border =</span> <span class="ot">NA</span>, <span class="dt">add =</span> add)</a>
<a class="sourceLine" id="cb38-18" data-line-number="18">}</a>
<a class="sourceLine" id="cb38-19" data-line-number="19"></a>
<a class="sourceLine" id="cb38-20" data-line-number="20"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mar =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1.6</span>, <span class="dv">0</span>, <span class="fl">1.9</span>, <span class="dv">0</span>)) <span class="co"># align plot limits with ternary plot</span></a>
<a class="sourceLine" id="cb38-21" data-line-number="21"><span class="kw">HorizontalHistogram</span>(correct1 <span class="op">/</span><span class="st"> </span>infoInTree1, col1)</a>
<a class="sourceLine" id="cb38-22" data-line-number="22"><span class="kw">HorizontalHistogram</span>(correct3 <span class="op">/</span><span class="st"> </span>infoInTree3, <span class="dt">col =</span> col3, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb38-23" data-line-number="23"><span class="kw"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="st">'\u2192 Normalized tree quality \u2192'</span>, <span class="dv">2</span>)</a></code></pre></div>
<p><img src="using-distances_files/figure-html/unnamed-chunk-18-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>In the ternary plot, the vertical direction corresponds to the normalized tree quality, as depicted in the accompanying histogram.</p>
</div>
</div>
<div id="what-next" class="section level2">
<h2 class="hasAnchor">
<a href="#what-next" class="anchor"></a>What next?</h2>
<ul>
<li><p>More details of the <a href="http://ms609.github.io/Ternary/">Ternary package</a></p></li>
<li><p>A summary of the <a href="tree-distances.html">distances implemented</a> in TreeDist</p></li>
</ul>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#normalizing">Normalizing</a></li>
      <li><a href="#testing-similarity-to-a-known-tree">Testing similarity to a known tree</a></li>
      <li><a href="#what-next">What next?</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://community.dur.ac.uk/martin.smith/">Martin R. Smith</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '8bf44d312479af73720c5ca5fcc12eba',
    indexName: 'treedist',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
