<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Calculate tree similarity with 'TreeDist' • TreeDist</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate tree similarity with 'TreeDist'">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-BTKEG66D3F"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-BTKEG66D3F');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TreeDist</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.11.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/Using-TreeDist.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Function reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tree distance analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/Using-TreeDist.html">Calculate tree similarity with 'TreeDist'</a></li>
    <li><a class="dropdown-item" href="../articles/using-distances.html">Contextualizing tree distances</a></li>
    <li><a class="dropdown-item" href="../articles/different-leaves.html">Trees with different leaves</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tree space analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/treespace.html">Tree space analysis</a></li>
    <li><a class="dropdown-item" href="../articles/landscapes.html">Analysing landscapes of phylogenetic trees</a></li>
    <li><a class="dropdown-item" href="../articles/compare-treesets.html">Comparing sets of trees from different analyses</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tree distance introductions</h6></li>
    <li><a class="dropdown-item" href="../articles/information.html">Comparing splits using information theory</a></li>
    <li><a class="dropdown-item" href="../articles/Robinson-Foulds.html">Extending the Robinson-Foulds metric</a></li>
    <li><a class="dropdown-item" href="../articles/Generalized-RF.html">Generalized Robinson-Foulds distances</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ms609/TreeDist"><span class="fa fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate tree similarity with 'TreeDist'</h1>
                        <h4 data-toc-skip class="author"><a href="https://smithlabdurham.github.io/" class="external-link">Martin R. Smith</a></h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ms609/TreeDist/blob/main/vignettes/Using-TreeDist.Rmd" class="external-link"><code>vignettes/Using-TreeDist.Rmd</code></a></small>
      <div class="d-none name"><code>Using-TreeDist.Rmd</code></div>
    </div>

    
    
<p>This document should contain all you need to get started measuring
tree distances with ‘TreeDist’. If you get stuck, please <a href="https://github.com/ms609/TreeDist/issues/new?title=Suggestion:+" class="external-link">let
me know</a> so I can improve this documentation.</p>
<div class="section level2">
<h2 id="loading-trees">Loading trees<a class="anchor" aria-label="anchor" href="#loading-trees"></a>
</h2>
<p>Instructions for loading phylogenetic trees into R can be found in a
<a href="https://ms609.github.io/TreeTools/articles/load-trees.html" class="external-link">separate
vignette</a>. For these examples, we’ll enter two simple trees by
hand:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree1</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'(A, ((B, (C, (D, E))), ((F, G), (H, I))));'</span><span class="op">)</span></span>
<span><span class="va">tree2</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">'(A, ((B, (C, (D, (H, I)))), ((F, G), E)));'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="calculating-distances">Calculating distances<a class="anchor" aria-label="anchor" href="#calculating-distances"></a>
</h2>
<p>We can calculate distances between pairs of trees using the
‘TreeDist’ package.</p>
<p>First we’ll install the package. We can either install the stable
version from the CRAN repository:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'TreeDist'</span><span class="op">)</span></span></code></pre></div>
<p>or the development version, from GitHub – which will contain the
latest features but may not be as extensively tested:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">'ms609/TreeDist'</span><span class="op">)</span></span></code></pre></div>
<p>Then we’ll load the package in to R’s working environment:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ms609.github.io/TreeDist/">'TreeDist'</a></span><span class="op">)</span></span></code></pre></div>
<p>Now the package’s functions are available within R. Let’s proceed to
calculate some tree distances.</p>
<div class="section level3">
<h3 id="pairs-of-trees">Pairs of trees<a class="anchor" aria-label="anchor" href="#pairs-of-trees"></a>
</h3>
<p>Calculating the distance between two trees is as simple as:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distance</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TreeDistance.html">TreeDistance</a></span><span class="op">(</span><span class="va">tree1</span>, <span class="va">tree2</span><span class="op">)</span></span></code></pre></div>
<p>The convenience function <code><a href="../reference/TreeDistance.html">TreeDistance()</a></code> returns the
variation of clustering information between two trees, <a href="using-distances.html#normalizing">normalized</a> against the total
information content of all splits.</p>
</div>
<div class="section level3">
<h3 id="multiple-comparisons">Multiple comparisons<a class="anchor" aria-label="anchor" href="#multiple-comparisons"></a>
</h3>
<p>If you have more than two trees to compare, you can send a list of
trees (class: <code>list</code> or <code>multiPhylo</code>) to the
distance comparison function. The function will then calculate the
distance between each tree in the first list and each tree in the
second.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oneTree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html" class="external-link">rtree</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span></span>
<span><span class="va">twoTrees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>one <span class="op">=</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html" class="external-link">rtree</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span>, two <span class="op">=</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html" class="external-link">rtree</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      class <span class="op">=</span> <span class="st">'multiPhylo'</span><span class="op">)</span></span>
<span><span class="va">threeTrees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html" class="external-link">rtree</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span>, b <span class="op">=</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html" class="external-link">rtree</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span>, c <span class="op">=</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html" class="external-link">rtree</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/TreeDistance.html">TreeDistance</a></span><span class="op">(</span><span class="va">oneTree</span>, <span class="va">twoTrees</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       one       two </span></span>
<span><span class="co">## 0.7826864 0.6856279</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/TreeDistance.html">TreeDistance</a></span><span class="op">(</span><span class="va">twoTrees</span>, <span class="va">threeTrees</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             a         b         c</span></span>
<span><span class="co">## one 0.8620894 0.7514794 0.7861809</span></span>
<span><span class="co">## two 0.8556624 0.7150163 0.7658788</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="visualizing-a-matching">Visualizing a matching<a class="anchor" aria-label="anchor" href="#visualizing-a-matching"></a>
</h2>
<p><a href="Generalized-RF.html">Generalized Robinson–Foulds
metrics</a>, such as the variation of clustering information, rely on
matching each split within a tree with another split in the other
tree.<br>
We can view an optimal matching:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/VisualizeMatching.html">VisualizeMatching</a></span><span class="op">(</span><span class="va">ClusteringInfoDistance</span>, <span class="va">tree1</span>, <span class="va">tree2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Using-TreeDist_files/figure-html/visualise-matching-1.png" alt="Pair of similar phylogenetic trees with matched splits highlighted according to the amount of clustering information in common." width="90%" style="display: block; margin: auto;"></p>
<p>This shows the six splits in tree 1, and the paired splits in tree
two.<br>
Each split is labelled with a measure of its similarity, which is its
contribution to the total tree similarity score.</p>
<p>We can view this information in a format accessible for further
examination in R with:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/TreeDistance.html">ClusteringInfoDistance</a></span><span class="op">(</span><span class="va">tree1</span>, <span class="va">tree2</span>, reportMatching <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 6.960578</span></span>
<span><span class="co">## attr(,"matching")</span></span>
<span><span class="co">## [1] 1 2 3 5 6 4</span></span>
<span><span class="co">## attr(,"matchedSplits")</span></span>
<span><span class="co">## [1] "B C D E | A F G H I =&gt; B C D H I | A E F G"</span></span>
<span><span class="co">## [2] "C D E | A B F G H I =&gt; C D H I | A B E F G"</span></span>
<span><span class="co">## [3] "D E | A B C F G H I =&gt; D H I | A B C E F G"</span></span>
<span><span class="co">## [4] "F G H I | A B C D E =&gt; E F G | A B C D H I"</span></span>
<span><span class="co">## [5] "F G | A B C D E H I =&gt; F G | A B C D E H I"</span></span>
<span><span class="co">## [6] "H I | A B C D E F G =&gt; H I | A B C D E F G"</span></span>
<span><span class="co">## attr(,"matchedScores")</span></span>
<span><span class="co">## [1] 0.09109101 0.07278023 0.02475761 0.07278023 0.76420451 0.76420451</span></span>
<span><span class="co">## attr(,"pairScores")</span></span>
<span><span class="co">##             [,1]        [,2]       [,3]       [,4]       [,5]       [,6]</span></span>
<span><span class="co">## [1,] 0.091091008 0.007214618 0.01831078 0.22478751 0.01831078 0.22478751</span></span>
<span><span class="co">## [2,] 0.018310782 0.072780226 0.00000000 0.15200728 0.00000000 0.15200728</span></span>
<span><span class="co">## [3,] 0.002565287 0.002565287 0.02475761 0.09288851 0.02475761 0.09288851</span></span>
<span><span class="co">## [4,] 0.007214618 0.007214618 0.07278023 0.31976006 0.07278023 0.31976006</span></span>
<span><span class="co">## [5,] 0.319760062 0.224787510 0.15200728 0.09288851 0.45810590 0.76420451</span></span>
<span><span class="co">## [6,] 0.224787510 0.319760062 0.45810590 0.76420451 0.15200728 0.09288851</span></span></code></pre>
<p>Here, the <code>pairScores</code> attribute lists the score of each
possible matching of splits.</p>
<p>We can identify the splits with:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">splits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu">TreeTools</span><span class="fu">::</span><span class="fu"><a href="https://ms609.github.io/TreeTools/reference/Splits.html" class="external-link">as.Splits</a></span><span class="op">(</span><span class="va">tree2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">splits</span></span></code></pre></div>
<pre><code><span><span class="co">##                    12                    13                    14 </span></span>
<span><span class="co">## "B C D H I | A F G E" "C D H I | A B F G E" "D H I | A B C F G E" </span></span>
<span><span class="co">##                    15                    16                    17 </span></span>
<span><span class="co">## "H I | A B C D F G E" "F G E | A B C D H I" "F G | A B C D H I E"</span></span></code></pre>
<p>The names of the splits correspond to the number of an associated
node in the original tree:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oldPar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree2</span><span class="op">)</span></span>
<span><span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/nodelabels.html" class="external-link">nodelabels</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/nodelabels.html" class="external-link">nodelabels</a></span><span class="op">(</span><span class="va">splits</span>, <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">splits</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="op">-</span><span class="fl">0.2</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span>, frame <span class="op">=</span> <span class="st">'none'</span><span class="op">)</span></span></code></pre></div>
<p><img src="Using-TreeDist_files/figure-html/named-splits-1.png" alt="Phylogenetic tree with nodes numbered, and labelled with the splits to which they correspond." width="80%" style="display: block; margin: auto;"></p>
<p>Note that strictly, (informative) splits are associated with
(internal) edges. To avoid listing the same split twice, nodes close to
the root (here, 10 and 11) will not be associated with a split.</p>
</div>
<div class="section level2">
<h2 id="what-next">What next?<a class="anchor" aria-label="anchor" href="#what-next"></a>
</h2>
<p>You may wish to:</p>
<ul>
<li><p><a href="using-distances.html">Provide context</a> for tree
distances</p></li>
<li><p>Compare trees with <a href="different-leaves.html">different
tips</a></p></li>
<li><p>Review <a href="https://ms609.github.io/TreeDist/index.html">available distance
measures</a> and the corresponding <a href="https://ms609.github.io/TreeDist/reference/index.html#section-tree-distance-measures">functions</a></p></li>
<li><p><a href="https://ms609.github.io/TreeDistData/articles/09-expected-similarity.html">Interpret
tree distance metrics</a></p></li>
<li><p>Visualize <a href="treespace.html">tree landscapes</a> using
distance-based tree spaces</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://smithlabdurham.github.io/" class="external-link">Martin R. Smith</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
