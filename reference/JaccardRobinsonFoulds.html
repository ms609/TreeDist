<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Jaccard-Robinson-Foulds metric — JaccardRobinsonFoulds • TreeDist</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Jaccard-Robinson-Foulds metric — JaccardRobinsonFoulds" />
<meta property="og:description" content="Implements the Jaccard-Robinson-Foulds metric of Böcker et al. (2013)." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TreeDist</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Generalized-RF.html">Generalized Robinson-Foulds distances</a>
    </li>
    <li>
      <a href="../articles/Robinson-Foulds.html">Robinson-Foulds metric</a>
    </li>
    <li>
      <a href="../articles/Tree-distance-metric-evaluation.html">Evaluating tree distance metrics</a>
    </li>
    <li>
      <a href="../articles/Using-TreeDist.html">Using TreeDist to calculate tree similarity</a>
    </li>
    <li>
      <a href="../articles/information.html">Information theory</a>
    </li>
    <li>
      <a href="../articles/tree-distances.html">Measuring tree distance</a>
    </li>
    <li>
      <a href="../articles/using-distances.html">Contextualizing tree distances</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ms609/TreeDist">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Jaccard-Robinson-Foulds metric</h1>
    <small class="dont-index">Source: <a href='https://github.com/ms609/TreeDist/blob/master/R/tree_distance_nye.R'><code>R/tree_distance_nye.R</code></a></small>
    <div class="hidden name"><code>JaccardRobinsonFoulds.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Implements the Jaccard-Robinson-Foulds metric of Böcker <em>et al</em>. (2013).</p>
    </div>

    <pre class="usage"><span class='fu'>JaccardRobinsonFoulds</span>(<span class='no'>tree1</span>, <span class='no'>tree2</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>1L</span>, <span class='kw'>arboreal</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>similarity</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>normalize</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>reportMatching</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='fu'>JaccardSplitSimilarity</span>(<span class='no'>splits1</span>, <span class='no'>splits2</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>1L</span>, <span class='kw'>arboreal</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>reportMatching</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>tree1</th>
      <td><p>Trees of class <code>phylo</code>, with tips labelled identically,
or lists of such trees to undergo pairwise comparison.</p></td>
    </tr>
    <tr>
      <th>tree2</th>
      <td><p>Trees of class <code>phylo</code>, with tips labelled identically,
or lists of such trees to undergo pairwise comparison.</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>An arbitrary exponent to which to raise the Jaccard index.
Integer values greater than one are anticipated by Böcker <em>et al</em>.
The Nye <em>et al</em>. metric uses <code>k = 1</code>.
As k → ∞, the metric converges to the Robinson-Foulds metric.</p></td>
    </tr>
    <tr>
      <th>arboreal</th>
      <td><p>Logical specifying whether to enforce arboreal matches, by
assigning zero similarity to contradictory pairs of partitions on an
<em>ad hoc</em> basis.</p></td>
    </tr>
    <tr>
      <th>similarity</th>
      <td><p>Logical specifying whether to report the result as a tree
similarity, rather than a difference.</p></td>
    </tr>
    <tr>
      <th>normalize</th>
      <td><p>If a numeric value is provided, this will be used as a
maximum value against which to rescale results.
If <code>TRUE</code>, results will be rescaled against a maximum value calculated from
the specified tree sizes and topology, as specified in the 'Normalization'
section below.
If <code>FALSE</code>, results will not be rescaled.</p></td>
    </tr>
    <tr>
      <th>reportMatching</th>
      <td><p>Logical specifying whether to return the clade
matchings as an attribute of the score.</p></td>
    </tr>
    <tr>
      <th>splits1</th>
      <td><p>Logical matrices where each row corresponds to a terminal,
either listed in the same order or bearing identical names (in any sequence),
and each column corresponds to a bipartition split, such that
each terminal is identified as a member of the ingroup (<code>TRUE</code>) or outgroup
(<code>FALSE</code>) of the respective bipartition split.</p></td>
    </tr>
    <tr>
      <th>splits2</th>
      <td><p>Logical matrices where each row corresponds to a terminal,
either listed in the same order or bearing identical names (in any sequence),
and each column corresponds to a bipartition split, such that
each terminal is identified as a member of the ingroup (<code>TRUE</code>) or outgroup
(<code>FALSE</code>) of the respective bipartition split.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>In short, this finds the optimal matching that pairs each branch from
one tree with a branch in the second, where matchings are scored according to
the size of the largest bipartition that is consistent with both of them,
normalized against the Jaccard index, and raised to an arbitrary exponent.</p>
<p>By default, arboreal matchings are enforced.</p>
<p>Note that the settings <code>k = 1, arboreal = FALSE</code> give the similarity metric
of Nye <em>et al</em>. (2006); a slightly faster implementation of this metric is
available as <code>[NyeTreeSimilarity]</code>.</p>
<p>The examples section details how to visualize matchings with non-default
parameter values.</p>
    <h2 class="hasAnchor" id="functions"><a class="anchor" href="#functions"></a>Functions</h2>

    
<ul>
<li><p><code>JaccardSplitSimilarity</code>: Calculate tree similarity from splits
instead of trees.</p></li>
</ul>
    <h2 class="hasAnchor" id="normalization"><a class="anchor" href="#normalization"></a>Normalization</h2>

    


<p>If <code>normalize = TRUE</code>, then results will be rescaled from zero to one by
dividing by the maximum possible value for trees of the given topologies,
which is equal to the number of partitions in both trees.
You may wish to normalize instead against the maximum number of partitions
present in a pair of trees with <em>n</em> terminals, by specifying
<code>normalize = n - 3</code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ul>
<li><p>Nye TMW, Liò P, Gilks WR (2006).
&#8220;A novel algorithm and web-based tool for comparing two alternative phylogenetic trees.&#8221;
<em>Bioinformatics</em>, <b>22</b>(1), 117--119.
doi: <a href='https://doi.org/10.1093/bioinformatics/bti720'>10.1093/bioinformatics/bti720</a>
.</p></li>
<li><p>Böcker S, Canzar S, Klau GW (2013).
&#8220;The generalized Robinson-Foulds metric.&#8221;
In Darling A, Stoye J (eds.), <em>Algorithms in Bioinformatics. WABI 2013. Lecture Notes in Computer Science, vol 8126</em>, 156--169.
Springer, Berlin, Heidelberg.</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other tree distances: <code><a href='KendallColijn.html'>KendallColijn</a></code>,
  <code><a href='MatchingSplitDistance.html'>MatchingSplitDistance</a></code>,
  <code><a href='NyeTreeSimilarity.html'>NyeTreeSimilarity</a></code>,
  <code><a href='RobinsonFouldsInfo.html'>RobinsonFouldsInfo</a></code>,
  <code><a href='TreeDistance.html'>TreeDistance</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>{
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>2</span>)
<span class='no'>tree1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>ape</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ape/man/rtree.html'>rtree</a></span>(<span class='fl'>10</span>)
<span class='no'>tree2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>ape</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ape/man/rtree.html'>rtree</a></span>(<span class='fl'>10</span>)
<span class='fu'>JaccardRobinsonFoulds</span>(<span class='no'>tree1</span>, <span class='no'>tree2</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>arboreal</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'>JaccardRobinsonFoulds</span>(<span class='no'>tree1</span>, <span class='no'>tree2</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>arboreal</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='no'>JRF2</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span> (<span class='no'>tree1</span>, <span class='no'>tree2</span>, <span class='no'>...</span>)
  <span class='fu'>JaccardRobinsonFoulds</span>(<span class='no'>tree1</span>, <span class='no'>tree2</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>arboreal</span><span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='fu'><a href='VisualizeMatching.html'>VisualizeMatching</a></span>(<span class='no'>JRF2</span>, <span class='no'>tree1</span>, <span class='no'>tree2</span>, <span class='kw'>matchZeros</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

}</div><div class='output co'>#&gt; <span class='warning'>Warning: conversion failure on '−' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;</span></div><div class='output co'>#&gt; <span class='warning'>Warning: conversion failure on '−' in 'mbcsToSbcs': dot substituted for &lt;88&gt;</span></div><div class='output co'>#&gt; <span class='warning'>Warning: conversion failure on '−' in 'mbcsToSbcs': dot substituted for &lt;92&gt;</span></div><div class='output co'>#&gt; <span class='warning'>Warning: conversion failure on '−' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;</span></div><div class='output co'>#&gt; <span class='warning'>Warning: conversion failure on '−' in 'mbcsToSbcs': dot substituted for &lt;88&gt;</span></div><div class='output co'>#&gt; <span class='warning'>Warning: conversion failure on '−' in 'mbcsToSbcs': dot substituted for &lt;92&gt;</span></div><div class='img'><img src='JaccardRobinsonFoulds-1.png' alt='' width='700' height='433' /></div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#functions">Functions</a></li>
      <li><a href="#normalization">Normalization</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Martin R. Smith</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://community.dur.ac.uk/martin.smith/'>Martin R. Smith</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '8bf44d312479af73720c5ca5fcc12eba',
    indexName: 'treedist',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


