<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Graphical user interface for mapping distances and analysing tree space — MapTrees • TreeDist</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Graphical user interface for mapping distances and analysing tree space — MapTrees"><meta property="og:description" content='MapTrees() launches a "Shiny" application for the visualization and
evaluation of tree spaces.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-BTKEG66D3F"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-BTKEG66D3F');
</script></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TreeDist</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.7.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>

  </a>
</li>
<li>
  <a href="../articles/Using-TreeDist.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Function reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="divider">
    <li class="dropdown-header">Tree distance analysis</li>
    <li>
      <a href="../articles/Using-TreeDist.html">Calculate tree similarity with 'TreeDist'</a>
    </li>
    <li>
      <a href="../articles/using-distances.html">Contextualizing tree distances</a>
    </li>
    <li>
      <a href="../articles/different-leaves.html">Trees with different leaves</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Tree space analysis</li>
    <li>
      <a href="../articles/treespace.html">Tree space analysis</a>
    </li>
    <li>
      <a href="../articles/landscapes.html">Analysing landscapes of phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/compare-treesets.html">Comparing sets of trees from different analyses</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Tree distance introductions</li>
    <li>
      <a href="../articles/information.html">Comparing splits using information theory</a>
    </li>
    <li>
      <a href="../articles/Robinson-Foulds.html">Extending the Robinson-Foulds metric</a>
    </li>
    <li>
      <a href="../articles/Generalized-RF.html">Generalized Robinson-Foulds distances</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ms609/TreeDist" class="external-link">
    <span class="fa fa-github fa-lg"></span>

  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>

    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Graphical user interface for mapping distances and analysing tree space</h1>
    <small class="dont-index">Source: <a href="https://github.com/ms609/TreeDist/blob/2.7.1/R/shiny.R" class="external-link"><code>R/shiny.R</code></a></small>
    <div class="hidden name"><code>MapTrees.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>MapTrees()</code> launches a "Shiny" application for the visualization and
evaluation of tree spaces.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MapTrees</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Project</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="input-tab">
    <h2>Input tab</h2>
    <p>The input tab allows for the upload of sets of phylogenetic trees from file.
Trees at the start or end of a file can be excluded, and the number of trees
can be brought down to a manageable number by uniformly subsampling every
_n_th tree.  Samples of c. 100 trees can be analysed in seconds;
analysis of larger samples will take longer, particularly with slower
methods (e.g. quartet distances; Kruskal-1 MDS; large minimum spanning trees).</p>
<p>Different batches can be plotted with different colours / symbols.</p>
<p>If each tree is associated with a property – for example, the data or method
used to generate it, or its stratigraphic congruence – a list of properties
for each tree, with one entry per line/row, can be uploaded along with
the trees.  Points in tree space can then be styled according to the
corresponding property.</p>
<p>If trees are subsampled (using the "Sample every" slider), then the values
in the tree properties file can also be subsampled accordingly.
Unfortunately there is not yet support for multiple point property files;
one file will be applied to all trees, in the sequence that they were added
to memory.</p>
    </div>
    <div id="analysis-tab">
    <h2>Analysis tab</h2>
    <p>Select from a suite of distance methods: clustering information and
phylogenetic information are quick and satisfactory; quartet is slow but
gives slightly better mappings; path is very fast but may not reflect
evolutionary signal very well; and Robinson–Foulds should probably never
be used for analysis; it is included for comparison purposes.</p>
<p>Principle components mappings should suffice for most purposes;
Sammon and Kruskal mappings are slower and seldom differ by much,
in character or quality, but may emphasize outliers more.</p>
<p>Partitioning around medoids or minimax-linkage hierarchical clustering
will typically find a close-to-optimal clustering where one exists;
select additional methods for a more exhaustive search.
To avoid redundant calculation, clusterings are only updated when
"recalculate clustering" is clicked, or the "maximum cluster number" slider
is modified; clustering solutions using more than this many clusters are
not considered
Clusterings with silhouette coefficients &lt; 0.25 are unlikely to represent
genuine structure and are not reported or depicted.</p>
    </div>
    <div id="display-tab">
    <h2>Display tab</h2>
    <p>Up to 15 dimensions can be depicted; the quality of a mapping – that is,
the faithfulness of mapped distances to true tree-to-tree distances –
is quantified by the product of the Trustworthiness and Continuity metrics,
which should exceed 0.9 (at least).</p>
<p>An interactive 3D plot can be explored by dragging the mouse and scrolling,
but do be careful to check that three dimensions are enough to depict your
data accurately.</p>
<p>The minimum spanning tree is the shortest possible line selecting the chosen
subsample of trees; if it takes a convoluted zig-zagging route, then the
mapping is doing a poor job of reflecting true tree to tree distances.</p>
<p>Convex hulls are the smallest polygons enclosing all points in each cluster;
they are handy for spotting clusters, but their area does not correspond
to a genuine quantity, so should not be interpreted.</p>
<p>Tree numbers correspond to the sequence of trees in their original input
file, before subsampling.</p>
<p>Each tree is denoted by a point, whose symbol can be styled according to
cluster membership or according to the file that contains the tree,
with each click of "Add to existing" on the input tab constituting a
new batch with a new symbol.</p>
<p>Points can be coloured according to a category – the cluster or batch to
which they belong, or custom data provided in the Point Property File
on the input tab – or continuously, either by the sequence in which they
were added to memory, or according to custom data.</p>
    </div>
    <div id="exporting-tree-spaces">
    <h2>Exporting tree spaces</h2>
    <p>A mapping can be saved to PDF or as a PNG bitmap at the size selected.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>A list of references employed when constructing the tree space is populated
according to the methods used; it would be appropriate to cite and briefly
discuss these studies in any publication using figures generated using
this application.  The application itself can be cited using
Smith (2020, 2022)</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Smith MR (2020).
“Information theoretic Generalized Robinson-Foulds metrics for comparing phylogenetic trees.”
<em>Bioinformatics</em>, <b>36</b>(20), 5007–5013.
<a href="https://doi.org/10.1093/bioinformatics/btaa614" class="external-link">doi:10.1093/bioinformatics/btaa614</a>
.<br><br> Smith MR (2022).
“Robust analysis of phylogenetic tree space.”
<em>Systematic Biology</em>, <b>71</b>(5), 1255–1270.
<a href="https://doi.org/10.1093/sysbio/syab100" class="external-link">doi:10.1093/sysbio/syab100</a>
.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Full detail of tree space analysis in R is provided in the accompanying
<a href="https://ms609.github.io/TreeDist/articles/treespace.html">vignette</a>.</p>
<p>Other tree space functions:
<code><a href="MSTSegments.html">MSTSegments</a>()</code>,
<code><a href="MappingQuality.html">MappingQuality</a>()</code>,
<code><a href="SpectralEigens.html">SpectralEigens</a>()</code>,
<code><a href="cluster-statistics.html">cluster-statistics</a></code>,
<code><a href="median.multiPhylo.html">median.multiPhylo</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p><a href="https://orcid.org/0000-0001-5660-1727" class="external-link">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://smithlabdurham.github.io/" class="external-link">Martin R. Smith</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({


    apiKey: '8bf44d312479af73720c5ca5fcc12eba',
    indexName: 'treedist',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

